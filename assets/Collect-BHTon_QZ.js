import{_ as O,r as I,N as Q,q as R,y as G,x as H,c as y,w as o,a as c,u as W,o as r,b as l,d as s,z as g,B as X,I as T,J as B,A as p,f as _,C as Y,e as b,L as w,F as Z,D as ee}from"./index-CnJvYQ85.js";import{M as se}from"./Input-Dtl65a7b.js";import{a as te}from"./sound-BznpVhuQ.js";import{u as oe}from"./token-CWvxNpoM.js";import{c as le,a as ae}from"./collect-CRxxK6lg.js";import"./request-Cy2-I7Tb.js";const ne={class:"action-bar"},ie={key:0},ce=["onClick"],re={style:{color:"#6b7280"}},de={style:{display:"flex","flex-direction":"row",gap:"10px"}},ue={style:{"font-weight":"520"}},pe={style:{"padding-top":"3%"}},me={style:{display:"flex","flex-direction":"row",gap:"10px",cursor:"pointer"}},_e={style:{color:"#71717a"}},fe={class:"audio-samples"},ve={class:"samples-content"},ye={class:"samples-index"},ge={class:"sample-btn"},he=["src"],ke=["src"],Ie=["onClick"],Ce=["onClick"],be={style:{"font-size":"small",color:"#71717a","padding-top":"10px"}},we={class:"btns"},xe={__name:"Collect",setup(Pe){const N=I("#f5f5f5"),x=W(),S=t=>{x.push({path:"/detail",query:{id:t}})};function $(t){C.value=t}const m=I([{voiceId:1,voiceImage:"http://yiyangqianxihsdkhejknfnbhuyjwes.online/975adcd7-15bf-44d4-a440-be2fbc972af1.jpg",voiceName:"曲志明",voiceDescription:"例面求上。果圆相称斗织是。开电年。同利算术极七等被来。问广十世。",voiceCreationTime:new Date(2025,1,9,19,11),voiceIsCollected:!0,voiceSamples:[{sampleId:83,sampleIsPlaying:!1,sampleTitle:"拨伟大快但是脊梁",sampleText:"consectetur",sampleUrl:te}]}]),C=I(""),U=I("搜索声音..."),E=Q(()=>m.value.filter(t=>t.voiceName.includes(C.value))),V=t=>new Intl.DateTimeFormat("zh-CN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(t)),h=R({}),P=(t,e)=>{const f=m.value.find(a=>a.voiceId===t);if(!f)return;const d=f.voiceSamples[e],v=`${t}-${e}`;if(h[v]){const a=h[v];d.sampleIsPlaying?a.pause():(Object.values(h).forEach(u=>u.pause()),a.play())}else{const a=new Audio(d.sampleUrl);h[v]=a,a.addEventListener("ended",()=>{d.sampleIsPlaying=!1}),a.play()}d.sampleIsPlaying=!d.sampleIsPlaying,f.voiceSamples.forEach((a,u)=>{u!==e&&(a.sampleIsPlaying=!1)})},j=t=>{x.push({path:"/explanation",query:{id:t}})},z=oe();G(async()=>{let t=await le(z.token.userId);m.value=t.data});const D=t=>{t.voiceIsCollected=!t.voiceIsCollected};return H(async()=>{const t=[];if(m.value.length>0&&(m.value.forEach(e=>{e.voiceIsCollected||t.push(e.voiceId)}),t.length>0)){const e=t.join(",");await ae({userId:z.token.userId,ids:e})}}),(t,e)=>{const f=c("el-header"),d=c("el-empty"),v=c("el-image"),a=c("el-col"),u=c("el-icon"),M=c("el-tag"),q=c("el-card"),F=c("el-popover"),L=c("el-row"),A=c("el-main"),J=c("el-container");return r(),y(J,{class:"sound-manager"},{default:o(()=>[l(f,{class:"display"},{default:o(()=>[e[0]||(e[0]=s("h1",{class:"title"},"我的收藏",-1)),s("div",ne,[l(se,{message:C.value,placeholder:U.value,color:N.value,class:"search-input","onUpdate:message":$},null,8,["message","placeholder","color"])])]),_:1}),l(A,null,{default:o(()=>[m.value.length===0?(r(),g("div",ie,[l(d,{description:"暂无数据"})])):X("",!0),(r(!0),g(T,null,B(E.value,n=>(r(),y(L,{key:n.voiceId,class:"voice-item"},{default:o(()=>[l(a,{span:2},{default:o(()=>[l(v,{style:{width:"70px",height:"70px","border-radius":"10px"},src:n.voiceImage,fit:"cover"},null,8,["src"])]),_:2},1024),l(a,{span:7},{default:o(()=>[s("div",{class:"voice-name",onClick:i=>S(n.voiceId)},p(n.voiceName),9,ce),s("div",re,p(n.voiceDescription),1)]),_:2},1024),l(a,{span:4},{default:o(()=>[e[1]||(e[1]=s("div",{class:"item"},"创建时间",-1)),s("div",de,[l(u,{size:"20",style:{color:"#6b7280"}},{default:o(()=>[l(_(Y))]),_:1}),s("span",ue,p(V(n.voiceCreationTime)),1)])]),_:2},1024),l(a,{span:3},{default:o(()=>[e[3]||(e[3]=s("div",{class:"item"},"状态",-1)),s("div",pe,[l(M,{type:"success",round:"",effect:"dark",style:{width:"50px","font-weight":"1000"}},{default:o(()=>e[2]||(e[2]=[b("成功")])),_:1})])]),_:1}),l(a,{span:4},{default:o(()=>[e[7]||(e[7]=s("div",{class:"item"},"音频示例",-1)),s("div",null,[l(F,{placement:"bottom",width:400,trigger:"click"},{reference:o(()=>[s("div",me,[e[4]||(e[4]=s("div",{class:"logo"},null,-1)),s("span",_e,p(n.voiceSamples.length)+" 音频示例",1)])]),default:o(()=>[s("div",fe,[e[6]||(e[6]=s("span",{style:{"font-size":"large","font-weight":"800",color:"black"}},"示例",-1)),(r(!0),g(T,null,B(n.voiceSamples,(i,k)=>(r(),y(q,{key:k,class:"samples-item",shadow:"never"},{default:o(()=>[s("div",ve,[s("div",null,[s("span",ye,p(k+1),1),s("span",null,p(i.sampleTitle),1)]),s("div",ge,[s("audio",null,[s("source",{src:i.sampleUrl,type:"audio/mp4"},null,8,he),s("source",{src:i.sampleUrl,type:"audio/x-m4a"},null,8,ke),e[5]||(e[5]=b(" 浏览器不支持音频播放 "))]),i.sampleIsPlaying?(r(),g("div",{key:1,class:"on",onClick:K=>{P(n.voiceId,k),i.sampleIsPlaying=!1}},null,8,Ce)):(r(),g("div",{key:0,class:"close",onClick:K=>{P(n.voiceId,k),i.sampleIsPlaying=!0}},null,8,Ie))])]),s("div",be,p(i.sampleText),1)]),_:2},1024))),128))])]),_:2},1024)])]),_:2},1024),l(a,{span:4},{default:o(()=>[s("div",we,[l(_(w),{size:"large",color:"black",onClick:i=>j(n.voiceId)},{default:o(()=>e[8]||(e[8]=[b("使用声音")])),_:2},1032,["onClick"]),n.voiceIsCollected?(r(),y(_(w),{key:0,size:"large",class:"btn",onClick:i=>D(n)},{default:o(()=>[l(u,{size:"25",color:"black"},{default:o(()=>[l(_(Z))]),_:1})]),_:2},1032,["onClick"])):(r(),y(_(w),{key:1,size:"large",class:"btn",onClick:i=>D(n)},{default:o(()=>[l(u,{size:"25",color:"black"},{default:o(()=>[l(_(ee))]),_:1})]),_:2},1032,["onClick"]))])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})}}},$e=O(xe,[["__scopeId","data-v-8a0eb3db"]]);export{$e as default};
