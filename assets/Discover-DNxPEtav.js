import{_ as J,r as g,I as R,u as W,p as X,J as Y,a as u,x as r,o as n,z as q,b as l,F as P,G as K,c as V,w as a,d as t,y as p,f as L,A as Z,e as N,B as ee,C as te,H as O,K as F,L as se}from"./index-CWysGPXy.js";import{t as oe}from"./time-tY07ncrd.js";import{a as A}from"./sound-BznpVhuQ.js";import{i as z}from"./request-BNQRLvKq.js";import{M as G}from"./Select-XYnX5rGK.js";import{M as le}from"./SelectChange-DgY25q07.js";import"./token-CzFfu787.js";const ae=()=>z.get("/discover"),ne=y=>z.post(`/discover/share?voiceId=${y}`),H=y=>z.put("/discover/like",y),ie=y=>z.put("/discover/collect",y),ce={key:0},de=["onClick"],re={class:"voice-detail"},ue={class:"display-detail"},pe={class:"display-detail"},ve={style:{display:"flex","flex-direction":"row",gap:"10px",cursor:"pointer"}},_e={class:"display-detail"},me={class:"audio-samples"},fe={class:"samples-content"},ge={class:"samples-index"},ke={class:"sample-btn"},ye=["src"],Ce=["src"],he=["onClick"],Ie=["onClick"],be={style:{"font-size":"small",color:"#71717a","padding-top":"10px"}},we={class:"tag1"},Le={key:0,class:"tag2",style:{"margin-left":"5px"}},Se={class:"voice-sample"},Ve={class:"sample-btn"},xe=["onClick"],$e=["onClick"],Ue={style:{width:"50%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","font-size":"small"}},Te={class:"btns"},De={class:"btns-plus"},Pe={class:"button"},Ne={class:"number"},ze={class:"button"},Ee=["onClick"],Be={class:"number"},Me={class:"button"},je=["onClick"],Ke=["onClick"],Oe={class:"number"},qe={class:"button"},Fe=["onClick"],Ae=["onClick"],Ge={class:"button"},He={class:"number"},Je={__name:"SoundItem",props:{sortValue:{type:String},languageValue:{type:String},tagValue:{type:String}},setup(y){const m=y,f=g([{voiceId:1,userName:"fc",voiceImage:"http://yiyangqianxihsdkhejknfnbhuyjwes.online/975adcd7-15bf-44d4-a440-be2fbc972af1.jpg",voiceName:"55",voiceDescription:"1212",voiceCreationTime:new Date(2025,1,9,19,11),voiceUseCount:11e4,voiceShareCount:11,voiceLikeCount:20,voiceCollectCount:10,voiceLanguage:"ch",voiceTag:"aaaaaaaaa",voiceIsUsed:!1,voiceIsShared:!1,voiceIsLiked:!1,voiceIsUnliked:!1,voiceIsCollected:!1,voiceSamples:[{sampleId:1,sampleIsPlaying:!1,sampleTitle:"Default Sample",sampleText:"哈哈哈笑死我了，这也太搞笑了吧！我靠我靠，这是什么神仙操作啊，太离谱了哩咯。笑得我肚子疼，这也太逗了吧，绝了绝了！",sampleUrl:A},{sampleId:2,sampleIsPlaying:!1,sampleTitle:"可以让父母",sampleText:"对侧人防热非人发热功耗一节课iklo",sampleUrl:A}]}]),x=R(()=>{let e=[...f.value];return m.tagValue===""?e=[...f.value]:m.tagValue!==""&&(e=e.filter(s=>s.voiceTag===m.tagValue)),m.languageValue!=="1"&&(e=e.filter(s=>s.voiceLanguage===m.languageValue)),m.sortValue==="2"?e.sort((s,v)=>new Date(v.voiceCreationTime)-new Date(s.voiceCreationTime)):m.sortValue==="1"&&e.sort((s,v)=>v.voiceUseCount-s.voiceUseCount),e}),$=W(),U=e=>{$.push({path:"/detail",query:{id:e}})},T=e=>{$.push({path:"/explanation",query:{id:e}})};function I(e){if(typeof e!="number"||isNaN(e))return e;const s=1e3;return e>=s*10?(e/s).toFixed(2)+"K":e}const b=X({}),S=(e,s)=>{const v=f.value.find(d=>d.voiceId===e);if(!v)return;const _=v.voiceSamples[s],c=`${e}-${s}`;if(b[c]){const d=b[c];_.sampleIsPlaying?d.pause():(Object.values(b).forEach(C=>C.pause()),d.play())}else{const d=new Audio(_.sampleUrl);b[c]=d,d.addEventListener("ended",()=>{_.sampleIsPlaying=!1}),d.play()}_.sampleIsPlaying=!_.sampleIsPlaying,v.voiceSamples.forEach((d,C)=>{C!==s&&(d.sampleIsPlaying=!1)})};Y(async()=>{let e=await ae();f.value=e.data});const E=e=>{const s=f.value.findIndex(c=>c.voiceId===e);f.value[s].voiceIsShared===!1&&(f.value[s].voiceIsShared=!0,f.value[s].voiceShareCount++);const _=`${window.location.href}?id=${e}`;navigator.clipboard.writeText(_).then(async()=>{O({message:"已复制到剪贴板",position:"bottom-right"});try{let c=await ne(e);console.log(c)}catch(c){console.error("分享服务调用失败:",c),O({message:`分享服务调用失败: ${c.message}`,position:"bottom-right",type:"error"})}}).catch(c=>{O({message:`复制失败: ${c.message}`,position:"bottom-right",type:"error"})})},D=async e=>{e.voiceIsLiked===1?(e.voiceIsLiked=0,e.voiceLikeCount--):(e.voiceIsLiked===2&&(e.voiceIsUnliked=!1),e.voiceIsLiked=1,e.voiceLikeCount++);const s={voiceId:e.voiceId,voiceLikeCount:e.voiceLikeCount};await H(s)},w=async e=>{e.voiceIsLiked===2?(e.voiceIsLiked=0,e.voiceIsUnliked=!1):(e.voiceIsLiked===1&&(e.voiceLikeCount--,e.voiceIsLiked=0),e.voiceIsLiked=2,e.voiceIsUnliked=!0);const s={voiceId:e.voiceId,voiceLikeCount:e.voiceLikeCount};await H(s)},k=async e=>{e.voiceIsCollected=!e.voiceIsCollected,e.voiceIsCollected?e.voiceCollectCount++:e.voiceCollectCount--;const s={voiceId:e.voiceId,voiceCollectCount:e.voiceCollectCount};await ie(s)};return(e,s)=>{const v=u("el-empty"),_=u("el-image"),c=u("el-col"),d=u("el-icon"),C=u("el-card"),B=u("el-popover"),M=u("el-button"),Q=u("el-row");return n(),r(P,null,[x.value.length===0?(n(),r("div",ce,[l(v,{description:"暂无数据"})])):q("",!0),(n(!0),r(P,null,K(x.value,o=>(n(),V(Q,{key:o.voiceId,class:"voice-item"},{default:a(()=>[l(c,{span:3},{default:a(()=>[l(_,{style:{width:"100px",height:"100px","border-radius":"15px"},src:o.voiceImage,fit:"cover"},null,8,["src"])]),_:2},1024),l(c,{span:21},{default:a(()=>[t("div",{class:"voice-name",onClick:i=>U(o.voiceId)},p(o.voiceName),9,de),t("div",re,[t("span",ue,p(o.userName),1),s[3]||(s[3]=t("div",{class:"dot"},null,-1)),l(d,{size:"20",style:{color:"#6b7280"}},{default:a(()=>[l(L(Z))]),_:1}),t("span",pe,p(L(oe)(o.voiceCreationTime)),1),s[4]||(s[4]=t("div",{class:"dot"},null,-1)),l(B,{placement:"bottom",width:400,trigger:"click"},{reference:a(()=>[t("div",ve,[s[0]||(s[0]=t("div",{class:"logo"},null,-1)),t("span",_e,p(o.voiceSamples.length)+" 音频示例",1)])]),default:a(()=>[t("div",me,[s[2]||(s[2]=t("span",{style:{"font-size":"large","font-weight":"800",color:"black"}},"示例",-1)),(n(!0),r(P,null,K(o.voiceSamples,(i,h)=>(n(),V(C,{key:h,class:"samples-item",shadow:"never"},{default:a(()=>[t("div",fe,[t("div",null,[t("span",ge,p(h+1),1),t("span",null,p(i.sampleTitle),1)]),t("div",ke,[t("audio",null,[t("source",{src:i.sampleUrl,type:"audio/mp4"},null,8,ye),t("source",{src:i.sampleUrl,type:"audio/x-m4a"},null,8,Ce),s[1]||(s[1]=N(" 浏览器不支持音频播放 "))]),i.sampleIsPlaying?(n(),r("div",{key:1,class:"on",onClick:j=>{S(o.voiceId,h),i.sampleIsPlaying=!1}},null,8,Ie)):(n(),r("div",{key:0,class:"close",onClick:j=>{S(o.voiceId,h),i.sampleIsPlaying=!0}},null,8,he))])]),t("div",be,p(i.sampleText),1)]),_:2},1024))),128))])]),_:2},1024),s[5]||(s[5]=t("div",{class:"dot"},null,-1)),t("div",we,p(o.voiceLanguage),1),o.voiceTag!==""?(n(),r("div",Le,p(o.voiceTag),1)):q("",!0)]),t("div",Se,[(n(!0),r(P,null,K(o.voiceSamples,(i,h)=>(n(),r("div",{key:h,class:"voice-sample-item"},[t("div",Ve,[i.sampleIsPlaying?(n(),r("div",{key:1,class:"on-plus",onClick:j=>S(o.voiceId,h)},null,8,$e)):(n(),r("div",{key:0,class:"close-plus",onClick:j=>S(o.voiceId,h)},null,8,xe))]),t("div",Ue,p(i.sampleText),1)]))),128))]),t("div",Te,[l(M,{size:"large",color:"black",onClick:i=>T(o.voiceId)},{default:a(()=>s[6]||(s[6]=[N("使用声音")])),_:2},1032,["onClick"]),t("div",De,[t("div",Pe,[s[7]||(s[7]=t("div",{class:"used"},null,-1)),t("div",Ne,p(I(o.voiceUseCount))+" Used ",1)]),t("div",ze,[t("div",{class:"shared",onClick:i=>E(o.voiceId)},null,8,Ee),t("div",Be,p(I(o.voiceShareCount))+" Shares ",1)]),t("div",Me,[o.voiceIsLiked===1?(n(),r("div",{key:0,class:"likefill",onClick:i=>D(o)},null,8,je)):(n(),r("div",{key:1,class:"like",onClick:i=>D(o)},null,8,Ke)),t("div",Oe,p(I(o.voiceLikeCount)),1)]),t("div",qe,[o.voiceIsLiked===2?(n(),r("div",{key:0,class:"unlikefill",onClick:i=>w(o)},null,8,Fe)):(n(),r("div",{key:1,class:"unlike",onClick:i=>w(o)},null,8,Ae))]),t("div",Ge,[o.voiceIsCollected?(n(),V(d,{key:1,size:"20",color:"#6b7280",style:{cursor:"pointer"},onClick:i=>k(o)},{default:a(()=>[l(L(te))]),_:2},1032,["onClick"])):(n(),V(d,{key:0,size:"20",color:"#6b7280",style:{cursor:"pointer"},onClick:i=>k(o)},{default:a(()=>[l(L(ee))]),_:2},1032,["onClick"])),t("div",He,p(I(o.voiceCollectCount)),1)])])])]),_:2},1024)]),_:2},1024))),128))],64)}}},Qe=J(Je,[["__scopeId","data-v-3e7afb62"]]),Re={class:"action-bar"},We={class:"content"},Xe={style:{display:"flex","justify-content":"center"}},Ye={__name:"Discover",setup(y){const m=g("#f5f5f5"),f=g([{value:"1",label:"推荐"},{value:"2",label:"最新"}]),x=g([{value:"1",label:"所有"},{value:"ch",label:"汉语"},{value:"en",label:"English"}]),$=g(),U=g(""),T=g("1"),I=g(""),b=g(""),S=k=>{U.value=k},E=k=>{T.value=k},D=k=>{b.value=k},w=g(!1);return(k,e)=>{const s=u("el-icon"),v=u("el-popover"),_=u("el-header"),c=u("el-main"),d=u("el-container"),C=u("el-col"),B=u("el-row");return n(),V(B,null,{default:a(()=>[l(C,{span:17},{default:a(()=>[l(d,{class:"sound-manager"},{default:a(()=>[l(_,{class:"display"},{default:a(()=>[e[7]||(e[7]=t("div",{class:"title"},"列表",-1)),t("div",Re,[e[5]||(e[5]=t("span",{class:"header-tip"},"排序",-1)),l(G,{options:f.value,"input-width":"230px",color:m.value,"onUpdate:value":S},null,8,["options","color"]),e[6]||(e[6]=t("span",{class:"header-tip"},"语言",-1)),l(G,{options:x.value,"input-width":"230px",color:m.value,"onUpdate:value":E},null,8,["options","color"]),l(v,{placement:"bottom",width:250,visible:w.value},{reference:a(()=>[l(L(F),{size:"large",class:"btn",onClick:e[0]||(e[0]=M=>w.value=!w.value)},{default:a(()=>[l(s,{size:"20",color:"black"},{default:a(()=>[l(L(se))]),_:1})]),_:1})]),default:a(()=>[t("div",We,[e[3]||(e[3]=t("div",{class:"content-header"},[t("span",{style:{"font-size":"large","font-weight":"600",color:"black"}},"筛选")],-1)),e[4]||(e[4]=t("div",null,"标签",-1)),l(le,{options:$.value,"input-width":"200px","onUpdate:value":D},null,8,["options"]),t("div",Xe,[l(L(F),{color:"black",style:{width:"95%"},onClick:e[1]||(e[1]=M=>{w.value=!1,I.value=b.value})},{default:a(()=>e[2]||(e[2]=[N("应用")])),_:1})])])]),_:1},8,["visible"])])]),_:1}),l(c,null,{default:a(()=>[l(Qe,{sortValue:U.value,languageValue:T.value,tagValue:I.value},null,8,["sortValue","languageValue","tagValue"])]),_:1})]),_:1})]),_:1}),l(C,{span:5},{default:a(()=>e[8]||(e[8]=[N("111")])),_:1})]),_:1})}}},nt=J(Ye,[["__scopeId","data-v-967d20c6"]]);export{nt as default};
