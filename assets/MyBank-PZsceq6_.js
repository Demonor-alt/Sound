import{_ as W,r as h,N as X,q as Y,y as Z,c as z,w as o,a as r,u as ee,o as p,b as t,d as s,f as d,L as f,e as v,O as te,z as b,B as se,I as N,J as T,A as _,C as oe,P as le,Q as ae}from"./index-2okebZPU.js";import{M as ne}from"./Input-AKu1H2h6.js";import{a as ie}from"./sound-BznpVhuQ.js";import{u as re}from"./token-rQigsGzs.js";import{c as ce,d as de}from"./mybank-DnN7T5lR.js";import"./request-CbvqqH3h.js";const ue={class:"action-bar"},pe={key:0},me=["onClick"],_e={style:{color:"#6b7280"}},fe={style:{display:"flex","flex-direction":"row",gap:"10px"}},ve={style:{"font-weight":"520"}},ye={style:{"padding-top":"3%"}},ge={style:{display:"flex","flex-direction":"row",gap:"10px",cursor:"pointer"}},ke={style:{color:"#71717a"}},he={class:"audio-samples"},be={class:"samples-content"},Ce={class:"samples-index"},Ie={class:"sample-btn"},we=["src"],xe=["src"],ze=["onClick"],Pe=["onClick"],Se={style:{"font-size":"small",color:"#71717a","padding-top":"10px"}},Ne={class:"btns"},Te={class:"dialog-footer"},Ve={__name:"MyBank",setup($e){const V=h("#f5f5f5"),y=h(!1),C=ee(),$=()=>{C.push("/createbank")},B=l=>{C.push({path:"/createbank",query:{id:l}})},D=l=>{C.push({path:"/detail",query:{id:l}})};function U(l){x.value=l}const g=h([{voiceId:70,voiceImage:"https://loremflickr.com/400/400?lock=567532027855895",voiceName:"曲志明",voiceDescription:"例面求上。果圆相称斗织是。开电年。同利算术极七等被来。问广十世。",voiceCreationTime:"2024-04-22 00:28:31",voiceIsCollected:!0,voiceSamples:[{sampleId:83,sampleIsPlaying:!1,sampleTitle:"拨伟大快但是脊梁",sampleText:"consectetur",sampleUrl:ie}]}]),x=h(""),M=h("搜索声音..."),E=X(()=>g.value.filter(l=>l.voiceName.includes(x.value))),L=l=>(l=new Date(l),new Intl.DateTimeFormat("zh-CN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(l)),I=Y({}),P=(l,e)=>{const u=g.value.find(i=>i.voiceId===l);if(!u)return;const m=u.voiceSamples[e],k=`${l}-${e}`;if(I[k]){const i=I[k];m.sampleIsPlaying?i.pause():(Object.values(I).forEach(c=>c.pause()),i.play())}else{const i=new Audio(m.sampleUrl);I[k]=i,i.addEventListener("ended",()=>{m.sampleIsPlaying=!1}),i.play()}m.sampleIsPlaying=!m.sampleIsPlaying,u.voiceSamples.forEach((i,c)=>{c!==e&&(i.sampleIsPlaying=!1)})},q=l=>{C.push({path:"/explanation",query:{id:l}})},F=re(),S=async()=>{try{const l=await ce(F.token.userId);g.value=l.data}catch(l){console.error("Failed to ",l),g.value=[]}};Z(()=>{S()});const A=async l=>{await de(l),S()};return(l,e)=>{const u=r("el-icon"),m=r("el-header"),k=r("el-empty"),i=r("el-image"),c=r("el-col"),O=r("el-tag"),Q=r("el-card"),j=r("el-popover"),J=r("el-dialog"),K=r("el-row"),R=r("el-main"),G=r("el-container");return p(),z(G,{class:"sound-manager"},{default:o(()=>[t(m,{class:"display"},{default:o(()=>[e[4]||(e[4]=s("h1",{class:"title"},"我的声音",-1)),s("div",ue,[t(ne,{message:x.value,placeholder:M.value,color:V.value,class:"search-input","onUpdate:message":U},null,8,["message","placeholder","color"]),t(d(f),{color:"black",onClick:$,class:"create-btn"},{default:o(()=>[t(u,{size:"20",style:{"padding-right":"5px"}},{default:o(()=>[t(d(te))]),_:1}),e[3]||(e[3]=v(" 创建新的声音 "))]),_:1})])]),_:1}),t(R,null,{default:o(()=>[g.value.length===0?(p(),b("div",pe,[t(k,{description:"暂无数据"})])):se("",!0),(p(!0),b(N,null,T(E.value,n=>(p(),z(K,{key:n.voiceId,class:"voice-item"},{default:o(()=>[t(c,{span:2},{default:o(()=>[t(i,{style:{width:"70px",height:"70px","border-radius":"10px"},src:n.voiceImage,fit:"cover"},null,8,["src"])]),_:2},1024),t(c,{span:7},{default:o(()=>[s("div",{style:{"font-size":"20px","font-weight":"800","padding-bottom":"10px",cursor:"pointer"},onClick:a=>D(n.voiceId)},_(n.voiceName),9,me),s("div",_e,_(n.voiceDescription),1)]),_:2},1024),t(c,{span:4},{default:o(()=>[e[5]||(e[5]=s("div",{class:"item"},"创建时间",-1)),s("div",fe,[t(u,{size:"20",style:{color:"#6b7280"}},{default:o(()=>[t(d(oe))]),_:1}),s("span",ve,_(L(n.voiceCreationTime)),1)])]),_:2},1024),t(c,{span:3},{default:o(()=>[e[7]||(e[7]=s("div",{class:"item"},"状态",-1)),s("div",ye,[t(O,{type:"success",round:"",effect:"dark",style:{width:"50px","font-weight":"1000"}},{default:o(()=>e[6]||(e[6]=[v("成功")])),_:1})])]),_:1}),t(c,{span:4},{default:o(()=>[e[11]||(e[11]=s("div",{class:"item"},"音频示例",-1)),s("div",null,[t(j,{placement:"bottom",width:400,trigger:"click"},{reference:o(()=>[s("div",ge,[e[8]||(e[8]=s("div",{class:"logo"},null,-1)),s("span",ke,_(n.voiceSamples.length)+" 音频示例",1)])]),default:o(()=>[s("div",he,[e[10]||(e[10]=s("span",{style:{"font-size":"large","font-weight":"800",color:"black"}},"示例",-1)),(p(!0),b(N,null,T(n.voiceSamples,(a,w)=>(p(),z(Q,{key:w,class:"samples-item",shadow:"never"},{default:o(()=>[s("div",be,[s("div",null,[s("span",Ce,_(w+1),1),s("span",null,_(a.sampleTitle),1)]),s("div",Ie,[s("audio",null,[s("source",{src:a.sampleUrl,type:"audio/mp4"},null,8,we),s("source",{src:a.sampleUrl,type:"audio/x-m4a"},null,8,xe),e[9]||(e[9]=v(" 浏览器不支持音频播放 "))]),a.sampleIsPlaying?(p(),b("div",{key:1,class:"on",onClick:H=>{P(n.voiceId,w),a.sampleIsPlaying=!1}},null,8,Pe)):(p(),b("div",{key:0,class:"close",onClick:H=>{P(n.voiceId,w),a.sampleIsPlaying=!0}},null,8,ze))])]),s("div",Se,_(a.sampleText),1)]),_:2},1024))),128))])]),_:2},1024)])]),_:2},1024),t(c,{span:4},{default:o(()=>[s("div",Ne,[t(d(f),{size:"large",color:"black",onClick:a=>q(n.voiceId)},{default:o(()=>e[12]||(e[12]=[v("使用声音")])),_:2},1032,["onClick"]),t(d(f),{size:"large",class:"btn",circle:"",onClick:a=>B(n.voiceId)},{default:o(()=>[t(u,{size:"20",color:"black"},{default:o(()=>[t(d(le))]),_:1})]),_:2},1032,["onClick"]),t(d(f),{size:"large",class:"btn",circle:"",onClick:e[0]||(e[0]=a=>y.value=!0)},{default:o(()=>[t(u,{size:"20",color:"black"},{default:o(()=>[t(d(ae))]),_:1})]),_:1}),t(J,{modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=a=>y.value=a),"align-center":"","show-close":!1,style:{width:"500px"}},{footer:o(()=>[s("span",Te,[t(d(f),{color:"black",plain:"",onClick:e[1]||(e[1]=a=>y.value=!1)},{default:o(()=>e[13]||(e[13]=[v("取消")])),_:1}),t(d(f),{color:"black",onClick:a=>{y.value=!1,A(n.voiceId)}},{default:o(()=>e[14]||(e[14]=[v(" 确认 ")])),_:2},1032,["onClick"])])]),default:o(()=>[e[15]||(e[15]=s("div",{style:{"font-size":"large","font-weight":"600"}},"您确定要删除语音吗",-1))]),_:2},1032,["modelValue"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})}}},qe=W(Ve,[["__scopeId","data-v-ca793b97"]]);export{qe as default};
