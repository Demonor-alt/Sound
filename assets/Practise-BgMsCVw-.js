import{_ as O,r as a,A as j,z as H,B as d,o as n,d as o,K as S,L as M,n as T,C as U,Y as J,e as x,y as Q,D as B,b as r,w as v,a as R,c as D,aa as oe,a7 as le,u as te,f as A,ab as Y,ac as se}from"./index-42p1iYeY.js";import{u as ae}from"./language-CL4JefrK.js";import{c as ne,a as ie}from"./teach-B5M12r26.js";import{a as G}from"./sound-BznpVhuQ.js";import"./request-V3eFzr9J.js";import"./token-BN2YJYas.js";const de={class:"content"},re=["src"],ue={class:"items"},ce=["onClick"],ve={__name:"Listen",props:{dataItem:{type:Object,default:()=>({})}},emits:["option-selected","clear-selection"],setup(f,{emit:$}){const w=a(null),u=a(null),p=$,c=()=>{w.value&&w.value.play()},y=(m,t)=>{u.value=m,p("option-selected",m===t)},_=()=>{u.value=null};return j(()=>{const m=()=>{_()};window.addEventListener("clear-selection",m),H(()=>{window.removeEventListener("clear-selection",m)})}),(m,t)=>(n(),d(S,null,[t[0]||(t[0]=o("h1",null,"你听到了什么?",-1)),o("div",de,[o("div",{class:"blueplay",onClick:c}),o("audio",{ref_key:"audioRef",ref:w,src:f.dataItem.audioURL,preload:"auto"},null,8,re),o("div",ue,[(n(!0),d(S,null,M(f.dataItem.options,l=>(n(),d("div",{key:l},[o("div",{class:T(["voice-item",{selected:u.value===l}]),onClick:k=>y(l,f.dataItem.answer)},U(l),11,ce)]))),128))])])],64))}},fe=O(ve,[["__scopeId","data-v-653cd698"]]),pe={class:"content"},me={key:0},be={key:1,style:{"border-bottom":"2px solid #e5e5e5",width:"50%",position:"relative",top:"20px"}},ye=["src"],ke={key:0},ge={key:1,style:{"border-bottom":"2px solid #e5e5e5",width:"50%",position:"relative",top:"20px"}},we=["src"],_e={class:"items"},Ce={__name:"Compare",props:{dataItem:{type:Object,default:()=>({})},shouldShowWord:{type:Boolean,default:!1}},emits:["option-selected","clear-selection"],setup(f,{emit:$}){const w=f,u=a(null),p=a(null),c=$,y=()=>{u.value&&u.value.play()},_=t=>{if(p.value=t,t==="same"){c("option-selected",!0);return}c("option-selected",!1)},m=()=>{p.value=null};return j(()=>{const t=()=>{m()};window.addEventListener("clear-selection",t),H(()=>{window.removeEventListener("clear-selection",t)})}),J(()=>w.shouldShowWord,(t,l)=>{console.log(`shouldShowWord 从 ${l} 变为 ${t}`)}),(t,l)=>(n(),d(S,null,[l[4]||(l[4]=o("h1",null,"听音辩词",-1)),o("div",pe,[o("div",{class:"audiodisplay top-audiodisplay",onClick:y},[l[2]||(l[2]=o("div",{class:"audioplay"},null,-1)),f.shouldShowWord?(n(),d("div",me,U(f.dataItem.options[0].practiseWord),1)):(n(),d("div",be)),o("audio",{ref_key:"audioRef",ref:u,src:f.dataItem.options[0].audioURL,preload:"auto"},null,8,ye)]),o("div",{class:"audiodisplay bottom-audiodisplay",onClick:y},[l[3]||(l[3]=o("div",{class:"audioplay"},null,-1)),f.shouldShowWord?(n(),d("div",ke,U(f.dataItem.options[1].practiseWord),1)):(n(),d("div",ge)),o("audio",{ref_key:"audioRef",ref:u,src:f.dataItem.options[1].audioURL,preload:"auto"},null,8,we)])]),l[5]||(l[5]=o("h3",null,"你听到的词是？",-1)),o("div",_e,[o("div",{class:T(["voice-item",{selected:p.value==="same"}]),onClick:l[0]||(l[0]=k=>_("same"))},"同一个词 ",2),o("div",{class:T(["voice-item",{selected:p.value==="notsame"}]),onClick:l[1]||(l[1]=k=>_("notsame"))}," 两个不同的词",2)])],64))}},xe=O(Ce,[["__scopeId","data-v-d967fcd8"]]),$e={class:"header"},he=["src"],Ve={class:"content"},Re={__name:"Speak",props:{dataItem:{type:Object,default:()=>({})}},emits:["option-selected"],setup(f,{emit:$}){const w=$,u=a(null),p=()=>{u.value&&u.value.play()},c=a(null),y=a([]),_=a(),m=a(),t=a(!1),l=a([]),k=async()=>{_.value=new Date;try{const b=await navigator.mediaDevices.getUserMedia({audio:!0});c.value=new MediaRecorder(b),y.value=[],c.value.ondataavailable=i=>{i.data.size>0&&y.value.push(i.data)},c.value.start(),t.value=!0,c.value.onstop=()=>{const i=new Blob(y.value,{type:"audio/mp3"});t.value=!1,b.getTracks().forEach(C=>C.stop()),z(i)}}catch(b){console.error("获取音频流失败：",b)}},h=()=>{c.value&&(c.value.stop(),t.value=!1)},z=async b=>{m.value=new Date;const i={name:`record-${l.value.length+1}.mp3`,url:URL.createObjectURL(b),blob:b,file:new File([b],`record-${l.value.length+1}.mp3`,{type:"audio/mp3"})};l.value.unshift(i);try{const C=new FormData;C.append("audio",i.file);let I=await ne(C);console.log("请求成功:",I),w("option-selected",!0)}catch(C){console.error("请求失败:",C)}};return(b,i)=>(n(),d(S,null,[i[3]||(i[3]=o("h1",null,"朗读下面的内容",-1)),o("div",$e,[o("div",{class:"toaudio",onClick:p},[i[0]||(i[0]=o("div",{class:"audioplay"},null,-1)),o("audio",{ref_key:"audioRef",ref:u,src:f.dataItem.audioURL,preload:"auto"},null,8,he),o("div",null,U(f.dataItem.practiseWord),1)])]),o("div",Ve,[t.value?(n(),d("div",{key:1,onClick:h,class:"voice-item"},i[2]||(i[2]=[o("div",{class:"recordgray"},null,-1),o("div",{style:{color:"#b5b5b5"}},"点击并开始录音",-1)]))):(n(),d("div",{key:0,class:"voice-item",style:{cursor:"pointer"},onClick:k},i[1]||(i[1]=[o("div",{class:"record"},null,-1),x(" 点击并开始录音 ")])))])],64))}},Se=O(Re,[["__scopeId","data-v-8da97d9a"]]),Ie={class:"main-container"},Le={class:"header"},Ue={class:"dialog-footer"},Oe={class:"demo-container"},ze={class:"col",style:{"overflow-y":"auto"}},Ee={key:0,class:"btn"},We={key:0,class:"voice-item",style:{opacity:"0.5",cursor:"not-allowed","border-bottom-width":"2px"}},Be={key:1,class:"btn",style:{"background-color":"#ffdfe0"}},De={style:{display:"flex","flex-direction":"row","align-items":"center",gap:"20px"}},Ae={class:"report"},Me={class:"feedback-dialog"},Te={class:"dialog-footer"},je={key:2,class:"btn",style:{"background-color":"#ccf2af"}},Ne={style:{display:"flex","flex-direction":"row","align-items":"center",gap:"20px"}},Pe={class:"report"},qe={class:"feedback-dialog"},Fe={class:"dialog-footer"},Ke={__name:"Practise",setup(f){const $=te(),{difficulty:w}=ae(),u=a(0),p=a(!1),c=a(!1),y=()=>{$.push("/teach")},_=[fe,xe,Se],m=a(!0),t=a(null),l=a(0),k=a(!1),h=a(!1),z=Q([{value:1,label:"我的答案不应被接受"},{value:2,label:"音频听起来不正确"},{value:3,label:"缺少音频"},{value:4,label:"其他问题"}]),b=Q([{value:1,label:"应该接受我的答案"},{value:2,label:"音频听起来不正确"},{value:3,label:"缺少音频"},{value:4,label:"其他问题"}]),i=a([]),C=a([]),I=a([{audioURL:G,options:["1","2"],answer:"1"},{audioURL:G,options:["3","4"],answer:"3"}]),L=a(1),X=()=>{P.value?t.value=1:t.value=0,c.value=!c.value},N=()=>{const g=new Event("clear-selection");window.dispatchEvent(g),L.value<I.value.length?L.value++:(L.value=1,l.value=(l.value+1)%_.length,q()),m.value=!0,u.value+=100,t.value=null,c.value=!c.value},P=a(!1),Z=g=>{m.value=!1,P.value=g},q=async()=>{const g={difficulty:w,questionType:l.value};let e=await ie(g);I.value=e.data};return j(()=>{q()}),J(u,g=>{g>=100&&$.push("/teach/success")}),(g,e)=>{const E=R("el-icon"),ee=R("el-slider"),V=R("el-button"),W=R("el-dialog"),F=R("el-checkbox"),K=R("el-checkbox-group");return n(),d("div",Ie,[o("div",Le,[r(E,{size:"30",style:{cursor:"pointer"},onClick:e[0]||(e[0]=s=>p.value=!0)},{default:v(()=>[r(A(Y))]),_:1}),r(ee,{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=s=>u.value=s),min:"0",max:"100",step:1,"show-tooltip":!1,"show-button":!1,size:"large"},null,8,["modelValue"]),r(W,{modelValue:p.value,"onUpdate:modelValue":e[4]||(e[4]=s=>p.value=s),width:"30%","align-center":"","show-close":!1},{footer:v(()=>[o("span",Ue,[r(V,{color:"#f4f4f5",plain:"",style:{color:"black",border:"#e4e4e7 1px solid"},onClick:e[2]||(e[2]=s=>p.value=!1)},{default:v(()=>e[15]||(e[15]=[x("取消")])),_:1}),r(V,{color:"black",onClick:e[3]||(e[3]=s=>{p.value=!1,y()})},{default:v(()=>e[16]||(e[16]=[x(" 确认 ")])),_:1})])]),default:v(()=>[e[17]||(e[17]=o("div",{style:{"font-size":"large",color:"black","font-weight":"600","margin-bottom":"10px"}},"退出练习",-1)),e[18]||(e[18]=o("div",{class:"dialog"}," 退出后不会保留进度 ",-1))]),_:1},8,["modelValue"])]),o("div",Oe,[o("div",ze,[(n(),D(oe(_[l.value]),{dataItem:I.value[L.value-1],shouldShowWord:c.value,onOptionSelected:Z},null,40,["dataItem","shouldShowWord"]))])]),o("div",{class:"divide",style:le({backgroundColor:t.value===null?"#e1e1e1":t.value===1?"#ccf2af":"#ffdfe0"})},null,4),t.value===null?(n(),d("div",Ee,[m.value?(n(),d("div",We," 检查 ")):(n(),d("div",{key:1,class:"voice-item",onClick:X,style:{"border-color":"#57a500","background-color":"#52be02",color:"white"}}," 检查 "))])):B("",!0),t.value===0?(n(),d("div",Be,[o("div",De,[r(E,{color:"#ea2b2b",size:"40",class:"myicon"},{default:v(()=>[r(A(Y))]),_:1}),o("div",Ae,[e[22]||(e[22]=o("div",{style:{color:"#ea2b2b","font-weight":"800","font-size":"25px"}},"还不太准确，再多听几次吧！",-1)),o("div",{class:"redbtn",onClick:e[5]||(e[5]=s=>h.value=!0)},e[19]||(e[19]=[o("div",{class:"flagred"},null,-1),x(" 报错 ")])),r(W,{modelValue:h.value,"onUpdate:modelValue":e[9]||(e[9]=s=>h.value=s),width:"20%","align-center":"","show-close":!1},{footer:v(()=>[o("span",Te,[r(V,{color:"#f4f4f5",plain:"",style:{color:"black",border:"#e4e4e7 1px solid"},onClick:e[7]||(e[7]=s=>h.value=!1)},{default:v(()=>e[20]||(e[20]=[x("取消")])),_:1}),r(V,{color:"black",onClick:e[8]||(e[8]=s=>{h.value=!1,g.visiblePopover=!1})},{default:v(()=>e[21]||(e[21]=[x(" 确认 ")])),_:1})])]),default:v(()=>[o("div",Me,[r(K,{modelValue:C.value,"onUpdate:modelValue":e[6]||(e[6]=s=>C.value=s),class:"checkbox-group"},{default:v(()=>[(n(!0),d(S,null,M(b,s=>(n(),D(F,{key:s.value,label:s.label,class:"checkbox-item"},null,8,["label"]))),128))]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])])]),o("div",{class:"voice-item",onClick:N,style:{"border-color":"#ea2b2b","background-color":"#ff4b4b",color:"white"}}," 继续 ")])):B("",!0),t.value===1?(n(),d("div",je,[o("div",Ne,[r(E,{color:"#58a700",size:"40",class:"myicon"},{default:v(()=>[r(A(se))]),_:1}),o("div",Pe,[e[26]||(e[26]=o("div",{style:{color:"#58a700","font-weight":"800","font-size":"25px"}},"你练得一副好听力，厉害呀！",-1)),o("div",{class:"greenbtn",onClick:e[10]||(e[10]=s=>k.value=!0)},e[23]||(e[23]=[o("div",{class:"flaggreen"},null,-1),x(" 报错 ")])),r(W,{modelValue:k.value,"onUpdate:modelValue":e[14]||(e[14]=s=>k.value=s),width:"20%","align-center":"","show-close":!1},{footer:v(()=>[o("span",Fe,[r(V,{color:"#f4f4f5",plain:"",style:{color:"black",border:"#e4e4e7 1px solid"},onClick:e[12]||(e[12]=s=>k.value=!1)},{default:v(()=>e[24]||(e[24]=[x("取消")])),_:1}),r(V,{color:"black",onClick:e[13]||(e[13]=s=>{k.value=!1,g.visiblePopover=!1})},{default:v(()=>e[25]||(e[25]=[x(" 确认 ")])),_:1})])]),default:v(()=>[o("div",qe,[r(K,{modelValue:i.value,"onUpdate:modelValue":e[11]||(e[11]=s=>i.value=s),class:"checkbox-group"},{default:v(()=>[(n(!0),d(S,null,M(z,s=>(n(),D(F,{key:s.value,label:s.label,class:"checkbox-item"},null,8,["label"]))),128))]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])])]),o("div",{class:"voice-item",onClick:N,style:{"border-color":"#57a500","background-color":"#52be02",color:"white"}}," 继续 ")])):B("",!0)])}}},Ze=O(Ke,[["__scopeId","data-v-087e9687"]]);export{Ze as default};
