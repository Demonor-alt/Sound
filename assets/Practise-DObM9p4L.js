import{_ as U,r as a,B as G,A as H,C as d,o as n,f as o,K as I,L as M,n as A,D as L,Y as J,g as w,z as q,E as W,e as r,a as v,b as R,c as B,aa as ee,a7 as oe,u as le,h as D,ab as K,ac as te}from"./index-BvlRsYmY.js";import{u as se}from"./language-BYoqnAHq.js";import{a as Y}from"./sound-BznpVhuQ.js";const ae={class:"content"},ne=["src"],ie={class:"items"},de=["onClick"],re={__name:"Listen",props:{dataItem:{type:Object,default:()=>({})}},emits:["option-selected","clear-selection"],setup(f,{emit:_}){const C=a(null),u=a(null),p=_,c=()=>{C.value&&C.value.play()},y=(m,l)=>{u.value=m,p("option-selected",m===l)},g=()=>{u.value=null};return G(()=>{const m=()=>{g()};window.addEventListener("clear-selection",m),H(()=>{window.removeEventListener("clear-selection",m)})}),(m,l)=>(n(),d(I,null,[l[0]||(l[0]=o("h1",null,"你听到了什么?",-1)),o("div",ae,[o("div",{class:"blueplay",onClick:c}),o("audio",{ref_key:"audioRef",ref:C,src:f.dataItem.audioURL,preload:"auto"},null,8,ne),o("div",ie,[(n(!0),d(I,null,M(f.dataItem.options,t=>(n(),d("div",{key:t},[o("div",{class:A(["voice-item",{selected:u.value===t}]),onClick:k=>y(t,f.dataItem.answer)},L(t),11,de)]))),128))])])],64))}},ue=U(re,[["__scopeId","data-v-653cd698"]]),ce={class:"content"},ve={key:0},fe={key:1,style:{"border-bottom":"2px solid #e5e5e5",width:"50%",position:"relative",top:"20px"}},pe=["src"],me={key:0},be={key:1,style:{"border-bottom":"2px solid #e5e5e5",width:"50%",position:"relative",top:"20px"}},ye=["src"],ke={class:"items"},ge={__name:"Compare",props:{dataItem:{type:Object,default:()=>({})},shouldShowWord:{type:Boolean,default:!1}},emits:["option-selected","clear-selection"],setup(f,{emit:_}){const C=f,u=a(null),p=a(null),c=_,y=()=>{u.value&&u.value.play()},g=l=>{if(p.value=l,l==="same"){c("option-selected",!0);return}c("option-selected",!1)},m=()=>{p.value=null};return G(()=>{const l=()=>{m()};window.addEventListener("clear-selection",l),H(()=>{window.removeEventListener("clear-selection",l)})}),J(()=>C.shouldShowWord,(l,t)=>{console.log(`shouldShowWord 从 ${t} 变为 ${l}`)}),(l,t)=>(n(),d(I,null,[t[4]||(t[4]=o("h1",null,"听音辩词",-1)),o("div",ce,[o("div",{class:"audiodisplay top-audiodisplay",onClick:y},[t[2]||(t[2]=o("div",{class:"audioplay"},null,-1)),f.shouldShowWord?(n(),d("div",ve,L(f.dataItem.options[0].practiseWord),1)):(n(),d("div",fe)),o("audio",{ref_key:"audioRef",ref:u,src:f.dataItem.options[0].audioURL,preload:"auto"},null,8,pe)]),o("div",{class:"audiodisplay bottom-audiodisplay",onClick:y},[t[3]||(t[3]=o("div",{class:"audioplay"},null,-1)),f.shouldShowWord?(n(),d("div",me,L(f.dataItem.options[1].practiseWord),1)):(n(),d("div",be)),o("audio",{ref_key:"audioRef",ref:u,src:f.dataItem.options[1].audioURL,preload:"auto"},null,8,ye)])]),t[5]||(t[5]=o("h3",null,"你听到的词是？",-1)),o("div",ke,[o("div",{class:A(["voice-item",{selected:p.value==="same"}]),onClick:t[0]||(t[0]=k=>g("same"))},"同一个词 ",2),o("div",{class:A(["voice-item",{selected:p.value==="notsame"}]),onClick:t[1]||(t[1]=k=>g("notsame"))}," 两个不同的词",2)])],64))}},we=U(ge,[["__scopeId","data-v-d967fcd8"]]),_e={class:"header"},Ce=["src"],xe={class:"content"},$e={__name:"Speak",props:{dataItem:{type:Object,default:()=>({})}},emits:["option-selected"],setup(f,{emit:_}){const C=_,u=a(null),p=()=>{u.value&&u.value.play()},c=a(null),y=a([]),g=a(),m=a(),l=a(!1),t=a([]),k=async()=>{g.value=new Date;try{const b=await navigator.mediaDevices.getUserMedia({audio:!0});c.value=new MediaRecorder(b),y.value=[],c.value.ondataavailable=i=>{i.data.size>0&&y.value.push(i.data)},c.value.start(),l.value=!0,c.value.onstop=()=>{const i=new Blob(y.value,{type:"audio/mp3"});l.value=!1,b.getTracks().forEach(h=>h.stop()),O(i)}}catch(b){console.error("获取音频流失败：",b)}},$=()=>{c.value&&(c.value.stop(),l.value=!1)},O=async b=>{m.value=new Date;const i={name:`record-${t.value.length+1}.mp3`,url:URL.createObjectURL(b),blob:b,file:new File([b],`record-${t.value.length+1}.mp3`,{type:"audio/mp3"})};t.value.unshift(i);try{new FormData().append("audio",i.file),C("option-selected",!0)}catch(h){console.error("请求失败:",h)}};return(b,i)=>(n(),d(I,null,[i[3]||(i[3]=o("h1",null,"朗读下面的内容",-1)),o("div",_e,[o("div",{class:"toaudio",onClick:p},[i[0]||(i[0]=o("div",{class:"audioplay"},null,-1)),o("audio",{ref_key:"audioRef",ref:u,src:f.dataItem.audioURL,preload:"auto"},null,8,Ce),o("div",null,L(f.dataItem.practiseWord),1)])]),o("div",xe,[l.value?(n(),d("div",{key:1,onClick:$,class:"voice-item"},i[2]||(i[2]=[o("div",{class:"recordgray"},null,-1),o("div",{style:{color:"#b5b5b5"}},"点击并开始录音",-1)]))):(n(),d("div",{key:0,class:"voice-item",style:{cursor:"pointer"},onClick:k},i[1]||(i[1]=[o("div",{class:"record"},null,-1),w(" 点击并开始录音 ")])))])],64))}},he=U($e,[["__scopeId","data-v-b74d6278"]]),Ve={class:"main-container"},Re={class:"header"},Ie={class:"dialog-footer"},Se={class:"demo-container"},Le={class:"col",style:{"overflow-y":"auto"}},Ue={key:0,class:"btn"},Oe={key:0,class:"voice-item",style:{opacity:"0.5",cursor:"not-allowed","border-bottom-width":"2px"}},ze={key:1,class:"btn",style:{"background-color":"#ffdfe0"}},Ee={style:{display:"flex","flex-direction":"row","align-items":"center",gap:"20px"}},We={class:"report"},Be={class:"feedback-dialog"},De={class:"dialog-footer"},Me={key:2,class:"btn",style:{"background-color":"#ccf2af"}},Ae={style:{display:"flex","flex-direction":"row","align-items":"center",gap:"20px"}},je={class:"report"},Ne={class:"feedback-dialog"},Pe={class:"dialog-footer"},Te={__name:"Practise",setup(f){const _=le(),{difficulty:C}=se(),u=a(0),p=a(!1),c=a(!1),y=()=>{_.push("/teach")},g=[ue,we,he],m=a(!0),l=a(null),t=a(0),k=a(!1),$=a(!1),O=q([{value:1,label:"我的答案不应被接受"},{value:2,label:"音频听起来不正确"},{value:3,label:"缺少音频"},{value:4,label:"其他问题"}]),b=q([{value:1,label:"应该接受我的答案"},{value:2,label:"音频听起来不正确"},{value:3,label:"缺少音频"},{value:4,label:"其他问题"}]),i=a([]),h=a([]),j=a([{audioURL:Y,options:["1","2"],answer:"1"},{audioURL:Y,options:["3","4"],answer:"3"}]),S=a(1),Q=()=>{P.value?l.value=1:l.value=0,c.value=!c.value},N=()=>{const x=new Event("clear-selection");window.dispatchEvent(x),S.value<j.value.length?S.value++:(S.value=1,t.value=(t.value+1)%g.length,queryType()),m.value=!0,u.value+=100,l.value=null,c.value=!c.value},P=a(!1),X=x=>{m.value=!1,P.value=x};return J(u,x=>{x>=100&&_.push("/teach/success")}),(x,e)=>{const z=R("el-icon"),Z=R("el-slider"),V=R("el-button"),E=R("el-dialog"),T=R("el-checkbox"),F=R("el-checkbox-group");return n(),d("div",Ve,[o("div",Re,[r(z,{size:"30",style:{cursor:"pointer"},onClick:e[0]||(e[0]=s=>p.value=!0)},{default:v(()=>[r(D(K))]),_:1}),r(Z,{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=s=>u.value=s),min:"0",max:"100",step:1,"show-tooltip":!1,"show-button":!1,size:"large"},null,8,["modelValue"]),r(E,{modelValue:p.value,"onUpdate:modelValue":e[4]||(e[4]=s=>p.value=s),width:"30%","align-center":"","show-close":!1},{footer:v(()=>[o("span",Ie,[r(V,{color:"#f4f4f5",plain:"",style:{color:"black",border:"#e4e4e7 1px solid"},onClick:e[2]||(e[2]=s=>p.value=!1)},{default:v(()=>e[15]||(e[15]=[w("取消")])),_:1}),r(V,{color:"black",onClick:e[3]||(e[3]=s=>{p.value=!1,y()})},{default:v(()=>e[16]||(e[16]=[w(" 确认 ")])),_:1})])]),default:v(()=>[e[17]||(e[17]=o("div",{style:{"font-size":"large",color:"black","font-weight":"600","margin-bottom":"10px"}},"退出练习",-1)),e[18]||(e[18]=o("div",{class:"dialog"}," 退出后不会保留进度 ",-1))]),_:1},8,["modelValue"])]),o("div",Se,[o("div",Le,[(n(),B(ee(g[t.value]),{dataItem:j.value[S.value-1],shouldShowWord:c.value,onOptionSelected:X},null,40,["dataItem","shouldShowWord"]))])]),o("div",{class:"divide",style:oe({backgroundColor:l.value===null?"#e1e1e1":l.value===1?"#ccf2af":"#ffdfe0"})},null,4),l.value===null?(n(),d("div",Ue,[m.value?(n(),d("div",Oe," 检查 ")):(n(),d("div",{key:1,class:"voice-item",onClick:Q,style:{"border-color":"#57a500","background-color":"#52be02",color:"white"}}," 检查 "))])):W("",!0),l.value===0?(n(),d("div",ze,[o("div",Ee,[r(z,{color:"#ea2b2b",size:"40",class:"myicon"},{default:v(()=>[r(D(K))]),_:1}),o("div",We,[e[22]||(e[22]=o("div",{style:{color:"#ea2b2b","font-weight":"800","font-size":"25px"}},"还不太准确，再多听几次吧！",-1)),o("div",{class:"redbtn",onClick:e[5]||(e[5]=s=>$.value=!0)},e[19]||(e[19]=[o("div",{class:"flagred"},null,-1),w(" 报错 ")])),r(E,{modelValue:$.value,"onUpdate:modelValue":e[9]||(e[9]=s=>$.value=s),width:"20%","align-center":"","show-close":!1},{footer:v(()=>[o("span",De,[r(V,{color:"#f4f4f5",plain:"",style:{color:"black",border:"#e4e4e7 1px solid"},onClick:e[7]||(e[7]=s=>$.value=!1)},{default:v(()=>e[20]||(e[20]=[w("取消")])),_:1}),r(V,{color:"black",onClick:e[8]||(e[8]=s=>{$.value=!1,x.visiblePopover=!1})},{default:v(()=>e[21]||(e[21]=[w(" 确认 ")])),_:1})])]),default:v(()=>[o("div",Be,[r(F,{modelValue:h.value,"onUpdate:modelValue":e[6]||(e[6]=s=>h.value=s),class:"checkbox-group"},{default:v(()=>[(n(!0),d(I,null,M(b,s=>(n(),B(T,{key:s.value,label:s.label,class:"checkbox-item"},null,8,["label"]))),128))]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])])]),o("div",{class:"voice-item",onClick:N,style:{"border-color":"#ea2b2b","background-color":"#ff4b4b",color:"white"}}," 继续 ")])):W("",!0),l.value===1?(n(),d("div",Me,[o("div",Ae,[r(z,{color:"#58a700",size:"40",class:"myicon"},{default:v(()=>[r(D(te))]),_:1}),o("div",je,[e[26]||(e[26]=o("div",{style:{color:"#58a700","font-weight":"800","font-size":"25px"}},"你练得一副好听力，厉害呀！",-1)),o("div",{class:"greenbtn",onClick:e[10]||(e[10]=s=>k.value=!0)},e[23]||(e[23]=[o("div",{class:"flaggreen"},null,-1),w(" 报错 ")])),r(E,{modelValue:k.value,"onUpdate:modelValue":e[14]||(e[14]=s=>k.value=s),width:"20%","align-center":"","show-close":!1},{footer:v(()=>[o("span",Pe,[r(V,{color:"#f4f4f5",plain:"",style:{color:"black",border:"#e4e4e7 1px solid"},onClick:e[12]||(e[12]=s=>k.value=!1)},{default:v(()=>e[24]||(e[24]=[w("取消")])),_:1}),r(V,{color:"black",onClick:e[13]||(e[13]=s=>{k.value=!1,x.visiblePopover=!1})},{default:v(()=>e[25]||(e[25]=[w(" 确认 ")])),_:1})])]),default:v(()=>[o("div",Ne,[r(F,{modelValue:i.value,"onUpdate:modelValue":e[11]||(e[11]=s=>i.value=s),class:"checkbox-group"},{default:v(()=>[(n(!0),d(I,null,M(O,s=>(n(),B(T,{key:s.value,label:s.label,class:"checkbox-item"},null,8,["label"]))),128))]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])])]),o("div",{class:"voice-item",onClick:N,style:{"border-color":"#57a500","background-color":"#52be02",color:"white"}}," 继续 ")])):W("",!0)])}}},Ye=U(Te,[["__scopeId","data-v-1c0a1830"]]);export{Ye as default};
