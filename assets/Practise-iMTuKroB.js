import{_ as j,r as t,z as d,o as r,d as l,A as H,e as c,I as O,q as F,B as h,b as s,w as n,a as C,c as B,aa as K,a5 as Q,u as X,f as D,ab as M,J as T,a7 as Y}from"./index-Cc-o6OeC.js";import{u as Z}from"./language-CVWvEhg5.js";import{c as ee}from"./teach-C5eIQzJF.js";import{a as le}from"./sound-BznpVhuQ.js";import"./request-C2Kdv6Y7.js";import"./token-C7-QUPg8.js";const oe={class:"content"},te=["src"],ae={__name:"Speak",props:{dataItem:{type:Object,default:()=>({})}},setup(U){const p=t(null),v=()=>{p.value&&p.value.play()},m=t(null),f=t([]),g=t(),S=t(),k=t(!1),y=t([]),u=async()=>{g.value=new Date;try{const i=await navigator.mediaDevices.getUserMedia({audio:!0});m.value=new MediaRecorder(i),f.value=[],m.value.ondataavailable=a=>{a.data.size>0&&f.value.push(a.data)},m.value.start(),k.value=!0,m.value.onstop=()=>{const a=new Blob(f.value,{type:"audio/mp3"});k.value=!1,i.getTracks().forEach(b=>b.stop()),w(a)}}catch(i){console.error("获取音频流失败：",i)}},V=()=>{m.value&&(m.value.stop(),k.value=!1)},w=async i=>{S.value=new Date;const a={name:`record-${y.value.length+1}.mp3`,url:URL.createObjectURL(i),blob:i,file:new File([i],`record-${y.value.length+1}.mp3`,{type:"audio/mp3"})};y.value.unshift(a);try{const b=new FormData;b.append("audio",a.file);let $=await ee(b);console.log("请求成功:",$)}catch(b){console.error("请求失败:",b)}};return(i,a)=>(r(),d(O,null,[a[3]||(a[3]=l("h1",null,"朗读下面的内容",-1)),l("div",oe,[l("div",{class:"toaudio",onClick:v},[a[0]||(a[0]=l("div",{class:"audioplay"},null,-1)),l("audio",{ref_key:"audioRef",ref:p,src:U.dataItem.audioURL,preload:"auto"},null,8,te),l("div",null,H(U.dataItem.practiseWord),1)]),k.value?(r(),d("div",{key:1,onClick:V,class:"voice-item"},a[2]||(a[2]=[l("div",{class:"record"},null,-1),c(" 停止录制 ")]))):(r(),d("div",{key:0,class:"voice-item",onClick:u},a[1]||(a[1]=[l("div",{class:"record"},null,-1),c(" 点击并开始录音 ")])))])],64))}},se=j(ae,[["__scopeId","data-v-7ad803b1"]]),ne={class:"main-container"},ie={class:"header"},re={class:"dialog-footer"},de={class:"demo-container"},ue={class:"col",style:{"overflow-y":"auto"}},ce={key:0,class:"btn"},ve={key:0,class:"voice-item",style:{opacity:"0.5",cursor:"not-allowed","border-bottom-width":"2px"}},fe={key:1,class:"btn",style:{"background-color":"#ffdfe0"}},pe={style:{display:"flex","flex-direction":"row","align-items":"center",gap:"20px"}},me={class:"report"},be={class:"feedback-dialog"},ge={class:"dialog-footer"},ke={key:2,class:"btn",style:{"background-color":"#ccf2af"}},ye={style:{display:"flex","flex-direction":"row","align-items":"center",gap:"20px"}},we={class:"report"},_e={class:"feedback-dialog"},xe={class:"dialog-footer"},Ce={__name:"Practise",setup(U){const{difficulty:p}=Z(),v=t(0),m=X(),f=t(!1),g=t(!1),S=()=>{m.push("/teach")},k=[se],y=t(!0),u=t(null),V=t(0),w=t(!1),i=t(!1),a=F([{value:1,label:"我的答案不应被接受"},{value:2,label:"音频听起来不正确"},{value:3,label:"缺少音频"},{value:4,label:"其他问题"}]),b=F([{value:1,label:"应该接受我的答案"},{value:2,label:"音频听起来不正确"},{value:3,label:"缺少音频"},{value:4,label:"其他问题"}]),$=t([]),L=t([]),E=t([{audioURL:le,practiseWord:"1"}]),R=t(1),q=()=>{A.value?u.value=1:u.value=0,g.value=!g.value},W=()=>{const _=new Event("clear-selection");window.dispatchEvent(_),R.value<E.value.length?R.value++:(R.value=1,V.value=(V.value+1)%k.length),y.value=!0,p===0?v.value+=100/12:p===1?v.value+=100/16:p===2?v.value+=100/20:p===3?v.value+=100/24:v.value+=100/28,u.value=null,g.value=!g.value},A=t(!1),J=_=>{y.value=!1,A.value=_};return(_,e)=>{const z=C("el-icon"),G=C("el-slider"),x=C("el-button"),I=C("el-dialog"),N=C("el-checkbox"),P=C("el-checkbox-group");return r(),d("div",ne,[l("div",ie,[s(z,{size:"30",style:{cursor:"pointer"},onClick:e[0]||(e[0]=o=>f.value=!0)},{default:n(()=>[s(D(M))]),_:1}),s(G,{modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=o=>v.value=o),min:"0",max:"100",step:1,"show-tooltip":!1,"show-button":!1,size:"large"},null,8,["modelValue"]),s(I,{modelValue:f.value,"onUpdate:modelValue":e[4]||(e[4]=o=>f.value=o),width:"30%","align-center":"","show-close":!1},{footer:n(()=>[l("span",re,[s(x,{color:"#f4f4f5",plain:"",style:{color:"black",border:"#e4e4e7 1px solid"},onClick:e[2]||(e[2]=o=>f.value=!1)},{default:n(()=>e[15]||(e[15]=[c("取消")])),_:1}),s(x,{color:"black",onClick:e[3]||(e[3]=o=>{f.value=!1,S()})},{default:n(()=>e[16]||(e[16]=[c(" 确认 ")])),_:1})])]),default:n(()=>[e[17]||(e[17]=l("div",{style:{"font-size":"large",color:"black","font-weight":"600","margin-bottom":"10px"}},"退出练习",-1)),e[18]||(e[18]=l("div",{class:"dialog"}," 退出后不会保留进度 ",-1))]),_:1},8,["modelValue"])]),l("div",de,[l("div",ue,[(r(),B(K(k[V.value]),{dataItem:E.value[R.value-1],shouldShowWord:g.value,onOptionSelected:J},null,40,["dataItem","shouldShowWord"]))])]),l("div",{class:"divide",style:Q({backgroundColor:u.value===null?"#e1e1e1":u.value===1?"#ccf2af":"#ffdfe0"})},null,4),u.value===null?(r(),d("div",ce,[y.value?(r(),d("div",ve," 检查 ")):(r(),d("div",{key:1,class:"voice-item",onClick:q,style:{"border-color":"#57a500","background-color":"#52be02",color:"white"}}," 检查 "))])):h("",!0),u.value===0?(r(),d("div",fe,[l("div",pe,[s(z,{color:"#ea2b2b",size:"40",class:"myicon"},{default:n(()=>[s(D(M))]),_:1}),l("div",me,[e[22]||(e[22]=l("div",{style:{color:"#ea2b2b","font-weight":"800","font-size":"25px"}},"还不太准确，再多听几次吧！",-1)),l("div",{class:"redbtn",onClick:e[5]||(e[5]=o=>i.value=!0)},e[19]||(e[19]=[l("div",{class:"flagred"},null,-1),c(" 报错 ")])),s(I,{modelValue:i.value,"onUpdate:modelValue":e[9]||(e[9]=o=>i.value=o),width:"20%","align-center":"","show-close":!1},{footer:n(()=>[l("span",ge,[s(x,{color:"#f4f4f5",plain:"",style:{color:"black",border:"#e4e4e7 1px solid"},onClick:e[7]||(e[7]=o=>i.value=!1)},{default:n(()=>e[20]||(e[20]=[c("取消")])),_:1}),s(x,{color:"black",onClick:e[8]||(e[8]=o=>{i.value=!1,_.visiblePopover=!1})},{default:n(()=>e[21]||(e[21]=[c(" 确认 ")])),_:1})])]),default:n(()=>[l("div",be,[s(P,{modelValue:L.value,"onUpdate:modelValue":e[6]||(e[6]=o=>L.value=o),class:"checkbox-group"},{default:n(()=>[(r(!0),d(O,null,T(b,o=>(r(),B(N,{key:o.value,label:o.label,class:"checkbox-item"},null,8,["label"]))),128))]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])])]),l("div",{class:"voice-item",onClick:W,style:{"border-color":"#ea2b2b","background-color":"#ff4b4b",color:"white"}}," 继续 ")])):h("",!0),u.value===1?(r(),d("div",ke,[l("div",ye,[s(z,{color:"#58a700",size:"40",class:"myicon"},{default:n(()=>[s(D(Y))]),_:1}),l("div",we,[e[26]||(e[26]=l("div",{style:{color:"#58a700","font-weight":"800","font-size":"25px"}},"你练得一副好听力，厉害呀！",-1)),l("div",{class:"greenbtn",onClick:e[10]||(e[10]=o=>w.value=!0)},e[23]||(e[23]=[l("div",{class:"flaggreen"},null,-1),c(" 报错 ")])),s(I,{modelValue:w.value,"onUpdate:modelValue":e[14]||(e[14]=o=>w.value=o),width:"20%","align-center":"","show-close":!1},{footer:n(()=>[l("span",xe,[s(x,{color:"#f4f4f5",plain:"",style:{color:"black",border:"#e4e4e7 1px solid"},onClick:e[12]||(e[12]=o=>w.value=!1)},{default:n(()=>e[24]||(e[24]=[c("取消")])),_:1}),s(x,{color:"black",onClick:e[13]||(e[13]=o=>{w.value=!1,_.visiblePopover=!1})},{default:n(()=>e[25]||(e[25]=[c(" 确认 ")])),_:1})])]),default:n(()=>[l("div",_e,[s(P,{modelValue:$.value,"onUpdate:modelValue":e[11]||(e[11]=o=>$.value=o),class:"checkbox-group"},{default:n(()=>[(r(!0),d(O,null,T(a,o=>(r(),B(N,{key:o.value,label:o.label,class:"checkbox-item"},null,8,["label"]))),128))]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])])]),l("div",{class:"voice-item",onClick:W,style:{"border-color":"#57a500","background-color":"#52be02",color:"white"}}," 继续 ")])):h("",!0)])}}},Ie=j(Ce,[["__scopeId","data-v-ba3a2580"]]);export{Ie as default};
