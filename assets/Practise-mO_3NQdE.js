import{_ as O,r as a,y as j,x as K,z as d,o as n,d as o,I,J as M,n as T,A as U,W as X,e as $,q as Q,B,b as r,w as c,a as R,c as D,aa as oe,a5 as le,u as te,f as A,ab as G,a7 as se}from"./index-DyRULsjU.js";import{u as ae}from"./language-Aa_Wx3Lx.js";import{c as ne,a as ie}from"./teach-BIZrPZKy.js";import{a as H}from"./sound-BznpVhuQ.js";import"./request-qor5qFn2.js";import"./token-LwoKb1bL.js";const de={class:"content"},re=["src"],ue={class:"items"},ce=["onClick"],ve={__name:"Listen",props:{dataItem:{type:Object,default:()=>({})}},emits:["option-selected","clear-selection"],setup(f,{emit:y}){const v=a(null),p=a(null),m=y,u=()=>{v.value&&v.value.play()},g=(b,t)=>{p.value=b,m("option-selected",b===t)},C=()=>{p.value=null};return j(()=>{const b=()=>{C()};window.addEventListener("clear-selection",b),K(()=>{window.removeEventListener("clear-selection",b)})}),(b,t)=>(n(),d(I,null,[t[0]||(t[0]=o("h1",null,"你听到了什么?",-1)),o("div",de,[o("div",{class:"blueplay",onClick:u}),o("audio",{ref_key:"audioRef",ref:v,src:f.dataItem.audioURL,preload:"auto"},null,8,re),o("div",ue,[(n(!0),d(I,null,M(f.dataItem.options,l=>(n(),d("div",{key:l},[o("div",{class:T(["voice-item",{selected:p.value===l}]),onClick:w=>g(l,f.dataItem.answer)},U(l),11,ce)]))),128))])])],64))}},fe=O(ve,[["__scopeId","data-v-653cd698"]]),pe={class:"content"},me={key:0},be={key:1,style:{"border-bottom":"2px solid #e5e5e5",width:"50%",position:"relative",top:"20px"}},ye=["src"],ke={key:0},ge={key:1,style:{"border-bottom":"2px solid #e5e5e5",width:"50%",position:"relative",top:"20px"}},we=["src"],_e={class:"items"},Ce={__name:"Compare",props:{dataItem:{type:Object,default:()=>({})},shouldShowWord:{type:Boolean,default:!1}},emits:["option-selected","clear-selection"],setup(f,{emit:y}){const v=f,p=a(null),m=a(null),u=y,g=()=>{p.value&&p.value.play()},C=t=>{if(m.value=t,t==="same"){u("option-selected",!0);return}u("option-selected",!1)},b=()=>{m.value=null};return j(()=>{const t=()=>{b()};window.addEventListener("clear-selection",t),K(()=>{window.removeEventListener("clear-selection",t)})}),X(()=>v.shouldShowWord,(t,l)=>{console.log(`shouldShowWord 从 ${l} 变为 ${t}`)}),(t,l)=>(n(),d(I,null,[l[4]||(l[4]=o("h1",null,"听音辩词",-1)),o("div",pe,[o("div",{class:"audiodisplay top-audiodisplay",onClick:g},[l[2]||(l[2]=o("div",{class:"audioplay"},null,-1)),f.shouldShowWord?(n(),d("div",me,U(f.dataItem.options[0].practiseWord),1)):(n(),d("div",be)),o("audio",{ref_key:"audioRef",ref:p,src:f.dataItem.options[0].audioURL,preload:"auto"},null,8,ye)]),o("div",{class:"audiodisplay bottom-audiodisplay",onClick:g},[l[3]||(l[3]=o("div",{class:"audioplay"},null,-1)),f.shouldShowWord?(n(),d("div",ke,U(f.dataItem.options[1].practiseWord),1)):(n(),d("div",ge)),o("audio",{ref_key:"audioRef",ref:p,src:f.dataItem.options[1].audioURL,preload:"auto"},null,8,we)])]),l[5]||(l[5]=o("h3",null,"你听到的词是？",-1)),o("div",_e,[o("div",{class:T(["voice-item",{selected:m.value==="same"}]),onClick:l[0]||(l[0]=w=>C("same"))},"同一个词 ",2),o("div",{class:T(["voice-item",{selected:m.value==="notsame"}]),onClick:l[1]||(l[1]=w=>C("notsame"))}," 两个不同的词",2)])],64))}},xe=O(Ce,[["__scopeId","data-v-d967fcd8"]]),$e={class:"header"},he=["src"],Ve={class:"content"},Re={__name:"Speak",props:{dataItem:{type:Object,default:()=>({})}},emits:["option-selected"],setup(f,{emit:y}){const v=y,p=a(null),m=()=>{p.value&&p.value.play()},u=a(null),g=a([]),C=a(),b=a(),t=a(!1),l=a([]),w=async()=>{C.value=new Date;try{const k=await navigator.mediaDevices.getUserMedia({audio:!0});u.value=new MediaRecorder(k),g.value=[],u.value.ondataavailable=i=>{i.data.size>0&&g.value.push(i.data)},u.value.start(),t.value=!0,u.value.onstop=()=>{const i=new Blob(g.value,{type:"audio/mp3"});t.value=!1,k.getTracks().forEach(x=>x.stop()),W(i)}}catch(k){console.error("获取音频流失败：",k)}},h=()=>{u.value&&(u.value.stop(),t.value=!1)},W=async k=>{b.value=new Date;const i={name:`record-${l.value.length+1}.mp3`,url:URL.createObjectURL(k),blob:k,file:new File([k],`record-${l.value.length+1}.mp3`,{type:"audio/mp3"})};l.value.unshift(i);try{const x=new FormData;x.append("audio",i.file);let S=await ne(x);console.log("请求成功:",S),v("option-selected",!0)}catch(x){console.error("请求失败:",x)}};return(k,i)=>(n(),d(I,null,[i[3]||(i[3]=o("h1",null,"朗读下面的内容",-1)),o("div",$e,[o("div",{class:"toaudio",onClick:m},[i[0]||(i[0]=o("div",{class:"audioplay"},null,-1)),o("audio",{ref_key:"audioRef",ref:p,src:f.dataItem.audioURL,preload:"auto"},null,8,he),o("div",null,U(f.dataItem.practiseWord),1)])]),o("div",Ve,[t.value?(n(),d("div",{key:1,onClick:h,class:"voice-item"},i[2]||(i[2]=[o("div",{class:"recordgray"},null,-1),o("div",{style:{color:"#b5b5b5"}},"点击并开始录音",-1)]))):(n(),d("div",{key:0,class:"voice-item",style:{cursor:"pointer"},onClick:w},i[1]||(i[1]=[o("div",{class:"record"},null,-1),$(" 点击并开始录音 ")])))])],64))}},Ie=O(Re,[["__scopeId","data-v-8da97d9a"]]),Se={class:"main-container"},Le={class:"header"},Ue={class:"dialog-footer"},Oe={class:"demo-container"},We={class:"col",style:{"overflow-y":"auto"}},ze={key:0,class:"btn"},Ee={key:0,class:"voice-item",style:{opacity:"0.5",cursor:"not-allowed","border-bottom-width":"2px"}},Be={key:1,class:"btn",style:{"background-color":"#ffdfe0"}},De={style:{display:"flex","flex-direction":"row","align-items":"center",gap:"20px"}},Ae={class:"report"},Me={class:"feedback-dialog"},Te={class:"dialog-footer"},je={key:2,class:"btn",style:{"background-color":"#ccf2af"}},qe={style:{display:"flex","flex-direction":"row","align-items":"center",gap:"20px"}},Ne={class:"report"},Pe={class:"feedback-dialog"},Fe={class:"dialog-footer"},Je={__name:"Practise",setup(f){const{difficulty:y}=ae(),v=a(0),p=te(),m=a(!1),u=a(!1),g=()=>{p.push("/teach")},C=[fe,xe,Ie],b=a(!0),t=a(null),l=a(0),w=a(!1),h=a(!1),W=Q([{value:1,label:"我的答案不应被接受"},{value:2,label:"音频听起来不正确"},{value:3,label:"缺少音频"},{value:4,label:"其他问题"}]),k=Q([{value:1,label:"应该接受我的答案"},{value:2,label:"音频听起来不正确"},{value:3,label:"缺少音频"},{value:4,label:"其他问题"}]),i=a([]),x=a([]),S=a([{audioURL:H,options:["1","2"],answer:"1"},{audioURL:H,options:["3","4"],answer:"3"}]),L=a(1),Y=()=>{N.value?t.value=1:t.value=0,u.value=!u.value},q=()=>{const _=new Event("clear-selection");window.dispatchEvent(_),L.value<S.value.length?L.value++:(L.value=1,l.value=(l.value+1)%C.length,P()),b.value=!0,y===0?v.value+=100/9:y===1?v.value+=100/12:y===2?v.value+=100/15:y===3?v.value+=100/18:v.value+=100/21,t.value=null,u.value=!u.value},N=a(!1),Z=_=>{b.value=!1,N.value=_},P=async()=>{const _={difficulty:y,questionType:l.value};let e=await ie(_);console.log(e.data),S.value=e.data};return j(()=>{P()}),X(v,_=>{_>=100&&p.push("/teach/success")}),(_,e)=>{const z=R("el-icon"),ee=R("el-slider"),V=R("el-button"),E=R("el-dialog"),F=R("el-checkbox"),J=R("el-checkbox-group");return n(),d("div",Se,[o("div",Le,[r(z,{size:"30",style:{cursor:"pointer"},onClick:e[0]||(e[0]=s=>m.value=!0)},{default:c(()=>[r(A(G))]),_:1}),r(ee,{modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=s=>v.value=s),min:"0",max:"100",step:1,"show-tooltip":!1,"show-button":!1,size:"large"},null,8,["modelValue"]),r(E,{modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=s=>m.value=s),width:"30%","align-center":"","show-close":!1},{footer:c(()=>[o("span",Ue,[r(V,{color:"#f4f4f5",plain:"",style:{color:"black",border:"#e4e4e7 1px solid"},onClick:e[2]||(e[2]=s=>m.value=!1)},{default:c(()=>e[15]||(e[15]=[$("取消")])),_:1}),r(V,{color:"black",onClick:e[3]||(e[3]=s=>{m.value=!1,g()})},{default:c(()=>e[16]||(e[16]=[$(" 确认 ")])),_:1})])]),default:c(()=>[e[17]||(e[17]=o("div",{style:{"font-size":"large",color:"black","font-weight":"600","margin-bottom":"10px"}},"退出练习",-1)),e[18]||(e[18]=o("div",{class:"dialog"}," 退出后不会保留进度 ",-1))]),_:1},8,["modelValue"])]),o("div",Oe,[o("div",We,[(n(),D(oe(C[l.value]),{dataItem:S.value[L.value-1],shouldShowWord:u.value,onOptionSelected:Z},null,40,["dataItem","shouldShowWord"]))])]),o("div",{class:"divide",style:le({backgroundColor:t.value===null?"#e1e1e1":t.value===1?"#ccf2af":"#ffdfe0"})},null,4),t.value===null?(n(),d("div",ze,[b.value?(n(),d("div",Ee," 检查 ")):(n(),d("div",{key:1,class:"voice-item",onClick:Y,style:{"border-color":"#57a500","background-color":"#52be02",color:"white"}}," 检查 "))])):B("",!0),t.value===0?(n(),d("div",Be,[o("div",De,[r(z,{color:"#ea2b2b",size:"40",class:"myicon"},{default:c(()=>[r(A(G))]),_:1}),o("div",Ae,[e[22]||(e[22]=o("div",{style:{color:"#ea2b2b","font-weight":"800","font-size":"25px"}},"还不太准确，再多听几次吧！",-1)),o("div",{class:"redbtn",onClick:e[5]||(e[5]=s=>h.value=!0)},e[19]||(e[19]=[o("div",{class:"flagred"},null,-1),$(" 报错 ")])),r(E,{modelValue:h.value,"onUpdate:modelValue":e[9]||(e[9]=s=>h.value=s),width:"20%","align-center":"","show-close":!1},{footer:c(()=>[o("span",Te,[r(V,{color:"#f4f4f5",plain:"",style:{color:"black",border:"#e4e4e7 1px solid"},onClick:e[7]||(e[7]=s=>h.value=!1)},{default:c(()=>e[20]||(e[20]=[$("取消")])),_:1}),r(V,{color:"black",onClick:e[8]||(e[8]=s=>{h.value=!1,_.visiblePopover=!1})},{default:c(()=>e[21]||(e[21]=[$(" 确认 ")])),_:1})])]),default:c(()=>[o("div",Me,[r(J,{modelValue:x.value,"onUpdate:modelValue":e[6]||(e[6]=s=>x.value=s),class:"checkbox-group"},{default:c(()=>[(n(!0),d(I,null,M(k,s=>(n(),D(F,{key:s.value,label:s.label,class:"checkbox-item"},null,8,["label"]))),128))]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])])]),o("div",{class:"voice-item",onClick:q,style:{"border-color":"#ea2b2b","background-color":"#ff4b4b",color:"white"}}," 继续 ")])):B("",!0),t.value===1?(n(),d("div",je,[o("div",qe,[r(z,{color:"#58a700",size:"40",class:"myicon"},{default:c(()=>[r(A(se))]),_:1}),o("div",Ne,[e[26]||(e[26]=o("div",{style:{color:"#58a700","font-weight":"800","font-size":"25px"}},"你练得一副好听力，厉害呀！",-1)),o("div",{class:"greenbtn",onClick:e[10]||(e[10]=s=>w.value=!0)},e[23]||(e[23]=[o("div",{class:"flaggreen"},null,-1),$(" 报错 ")])),r(E,{modelValue:w.value,"onUpdate:modelValue":e[14]||(e[14]=s=>w.value=s),width:"20%","align-center":"","show-close":!1},{footer:c(()=>[o("span",Fe,[r(V,{color:"#f4f4f5",plain:"",style:{color:"black",border:"#e4e4e7 1px solid"},onClick:e[12]||(e[12]=s=>w.value=!1)},{default:c(()=>e[24]||(e[24]=[$("取消")])),_:1}),r(V,{color:"black",onClick:e[13]||(e[13]=s=>{w.value=!1,_.visiblePopover=!1})},{default:c(()=>e[25]||(e[25]=[$(" 确认 ")])),_:1})])]),default:c(()=>[o("div",Pe,[r(J,{modelValue:i.value,"onUpdate:modelValue":e[11]||(e[11]=s=>i.value=s),class:"checkbox-group"},{default:c(()=>[(n(!0),d(I,null,M(W,s=>(n(),D(F,{key:s.value,label:s.label,class:"checkbox-item"},null,8,["label"]))),128))]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])])]),o("div",{class:"voice-item",onClick:q,style:{"border-color":"#57a500","background-color":"#52be02",color:"white"}}," 继续 ")])):B("",!0)])}}},Ze=O(Je,[["__scopeId","data-v-ecf91f8f"]]);export{Ze as default};
