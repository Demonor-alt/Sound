import{r as n,d as X,z as Y,B as Z,c as F,a as r,b as g,o as u,e as i,f as o,C as p,E as N,h as R,g as w,K as ee,L as ae,D as U,U as te}from"./index-DjNsE5ME.js";import{u as oe,S as se}from"./step-ylkiapKp.js";import{e as ne,f as le}from"./mybank-Ccy2O2o8.js";import"./request-BZju35HV.js";import"./token-JUswVa07.js";const ie=["src"],ce={key:1},re={class:"audio-upload"},ue={class:"audio-player"},de={class:"audio-upload"},pe={class:"size"},fe=["onClick"],me=["onClick"],ve={key:3,class:"btnssecond"},he={__name:"Teacher",setup(_e){const $=n([{sampleId:"",sampleTitle:"",sampleText:"",sampleUrl:"",sampleIsPlaying:!1}]),z=X(),b=z.query?z.query.id:void 0,d=n([]),k=n(!1),y=n(null),h=n([]),I=n(),B=n(),E=async()=>{I.value=new Date;try{const e=await navigator.mediaDevices.getUserMedia({audio:!0});y.value=new MediaRecorder(e),h.value=[],y.value.ondataavailable=a=>{a.data.size>0&&h.value.push(a.data)},y.value.start(),k.value=!0,y.value.onstop=()=>{const a=new Blob(h.value,{type:"audio/mp3"});a.value=a,k.value=!1,e.getTracks().forEach(s=>s.stop()),O(a)}}catch(e){console.error("获取音频流失败：",e)}};function M(e,a){const s=new Date(e),c=new Date(a),t=Math.abs(c.getTime()-s.getTime());return Math.floor(t/1e3)}const O=async e=>{B.value=new Date;const a={name:`record-${d.value.length+1}.mp3`,url:URL.createObjectURL(e),blob:e,duration:`${M(I.value,B.value)}s`,size:T(e.size),file:new File([e],`record-${d.value.length+1}.mp3`,{type:"audio/mp3"})};d.value.unshift(a)},j=()=>{y.value&&(y.value.stop(),k.value=!1)},T=e=>`${(e/1024).toFixed(2)} KB`,q=e=>isNaN(e)||e===1/0?"未知":`${Math.floor(e)}s`,x=async e=>{const a=URL.createObjectURL(e),s=new Audio(URL.createObjectURL(e));return await new Promise(c=>{s.addEventListener("loadedmetadata",()=>{const t=s.duration,_=q(t),f={name:e.name,size:T(e.size),duration:_,isPlaying:!1,url:a,file:e,actualDuration:t};d.value.push(f),c()})}),!1},l=Y({}),L=e=>{const a=d.value[e];l[e]||(l[e]=new Audio(a.url));const s=l[e];a.isPlaying?s.pause():(Object.entries(l).forEach(([c,t])=>{c!=e&&!t.paused&&(t.pause(),d.value[c].isPlaying=!1)}),s.play()),a.isPlaying=!a.isPlaying,s.addEventListener("ended",()=>{a.isPlaying=!1})},K=e=>{l[e]&&(l[e].pause(),l[e].src="",delete l[e]),d.value.splice(e,1)},P=n("second"),Q=()=>{S.incrementStep()},S=oe(),G=n(""),C=n({voiceType:"1",voiceImage:"",voiceName:"",voiceDescription:"",voiceTag:"",voiceLanguage:1}),A=n(),H=async()=>{const e=new FormData;e.append("text","在信息爆炸的时代，我们每天被海量的数据包围，而阅读，这一古老的行为，却依旧散发着独特且强大的魅力，拥有着不可估量的力量。​阅读是一座取之不尽的知识宝库。通过书籍，我们能穿越时空，与古圣先贤对话。翻开《论语》，便能聆听孔子及其弟子的智慧言论，体悟为人处世的准则与道德修养的真谛；研读《物种起源》，跟随达尔文的脚步，探索生命演化的奥秘，了解物种如何在漫长岁月中适应环境、不断进化。无论是历史、科学、文学还是艺术，每一本书都是作者知识与经验的结晶，阅读使我们能在有限的生命里，汲取无限的知识养分，拓宽认知边界，丰富精神世界。​阅读能够深度拓展我们的思维。当沉浸在一本推理小说中，如阿加莎・克里斯蒂的作品，我们会跟随主角的视角，抽丝剥茧地分析线索，从错综复杂的情节中推断出真相，这一过程极大地锻炼了逻辑思维能力。而阅读哲学书籍，像尼采的《查拉图斯特拉如是说》，那些深邃的思想和独特的观点，会促使我们突破常规思维的局限，以全新视角审视世界、思考人生意义，培养批判性思维与创新思维，让我们在面对生活中的问题时，能从更多维度去分析和解决。​阅读更是心灵的滋养剂。在疲惫的生活中，一本温暖的治愈系书籍能成为心灵的避风港。当我们翻开《小王子》，被那纯真的故事和深刻的哲理触动，小王子与狐狸之间真挚的情感，让我们重新审视人与人之间的关系，唤起内心深处那份被遗忘的童真与善良，抚平生活带来的焦虑与创伤。文学作品中的优美语句，如潺潺溪流，润泽我们的心田，让我们在喧嚣尘世中寻得片刻宁静，感受到人性的美好与生命的价值。​阅读的力量，还在于它能引发共鸣，连接不同的灵魂。当我们读到与自己经历相似、情感契合的文字时，那种心有灵犀的感觉，仿佛在茫茫人海中找到了知音。这种共鸣跨越了年龄、性别、地域的界限，让全球的读者因共同喜爱的书籍相聚在一起，分享感悟，交流思想，形成一个庞大而温暖的精神共同体。​阅读，以无声的力量塑造着我们的知识体系、思维模式和心灵世界，如同点点繁星，照亮我们前行的道路，引领我们在人生旅途中不断探索、成长，领略世间无尽的美好。​不知你对这篇关于阅读力量的文章是否满意？要是你希望更换主题，或是在风格、内容侧重点上有其他想法，都能跟我讲，我会据此修改。"),e.append("text_lang","zh"),e.append("prompt_lang","zh"),e.append("media_type","mp3");for(const f of d.value)e.append("ref_audio",f.file);console.log("最终 FormData 内容:",Array.from(e.entries())),n(null);const a=new AudioContext;n(null);const c=(await fetch("/api2/tts",{method:"POST",body:e})).body.getReader(),t=[],_=async()=>{const{done:f,value:D}=await c.read();if(f){const m=await a.decodeAudioData(new Uint8Array(t).buffer),v=a.createBufferSource();v.buffer=m,v.connect(a.destination),v.start();return}t.push(...D),_()};_()},J=async()=>{await H(),Object.keys(l).forEach(e=>{l[e].pause(),l[e].src="",delete l[e]}),S.incrementStep()};Z(async()=>{if(b!==void 0){let e=await ne(b);C.value=e.data,$.value=e.data.voiceSamples}});const W=async()=>{({...C,voiceId:G.value},await le(C.value)),S.incrementStep()};return(e,a)=>{const s=g("el-upload"),c=g("el-tab-pane"),t=g("el-col"),_=g("el-icon"),f=g("el-row"),D=g("el-tabs");return u(),F(f,null,{default:r(()=>[i(t,{span:12},{default:r(()=>[o("div",null,[A.value?(u(),p("audio",{key:0,src:A.value,controls:"",class:"audio-player",style:{"margin-top":"20px"}},"您的浏览器不支持音频播放",8,ie)):N("",!0),R(b)===void 0?(u(),p("div",ce,[a[5]||(a[5]=o("h3",null,"输入音频",-1)),i(D,{modelValue:P.value,"onUpdate:modelValue":a[0]||(a[0]=m=>P.value=m),class:"demo-tabs"},{default:r(()=>[i(c,{label:"上传音频",name:"second"},{default:r(()=>[o("div",re,[i(s,{class:"upload-component",accept:"audio/*","before-upload":x,"show-file-list":!1,"file-list":d.value,"on-remove":e.handleRemove,limit:0},{default:r(()=>a[1]||(a[1]=[o("div",{class:"upload-button"},[o("div",{class:"insert"}),o("h5",null,"添加或删除您的音频文件")],-1)])),_:1},8,["file-list","on-remove"])])]),_:1}),i(c,{label:"录制音频",name:"first"},{default:r(()=>[o("div",ue,[k.value?(u(),p("div",{key:1,onClick:j,class:"record"},a[3]||(a[3]=[o("div",{class:"noRecord"},null,-1),w(" 停止录制 ")]))):(u(),p("div",{key:0,onClick:E,class:"record"},a[2]||(a[2]=[o("div",{class:"inRecord"},null,-1),w(" 点击开始录制 ")]))),a[4]||(a[4]=o("div",{style:{"font-size":"small",color:"#6b7280","margin-left":"20px"}}," *您可以使用自己的文本或下面的建议文本录制您的声音。",-1)),i(se)])]),_:1}),o("div",de,[(u(!0),p(ee,null,ae(d.value,(m,v)=>(u(),F(f,{key:v,class:"files"},{default:r(()=>[i(t,{span:2,class:"logo"}),i(t,{span:13,class:"file"},{default:r(()=>[w(U(m.name)+" ",1),o("div",pe,U(m.size),1)]),_:2},1024),i(t,{span:4},{default:r(()=>[w(U(m.duration),1)]),_:2},1024),i(t,{span:4,class:"btns"},{default:r(()=>[m.isPlaying?(u(),p("div",{key:1,class:"on",onClick:V=>L(v)},null,8,me)):(u(),p("div",{key:0,class:"close",onClick:V=>L(v)},null,8,fe)),i(_,{onClick:V=>K(v),class:"delete-btn",size:"25"},{default:r(()=>[i(R(te))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))])]),_:1},8,["modelValue"])])):N("",!0),R(b)===void 0?(u(),p("button",{key:2,class:"next-btn",onClick:J},"创建")):(u(),p("div",ve,[o("button",{class:"next-btn",onClick:W},"保存"),o("button",{class:"skip",onClick:Q},"跳过")]))])]),_:1})]),_:1})}}};export{he as default};
