import{h as A}from"./howler-YKEUKyjS.js";import{r as u,z as K,c as B,a as c,b as _,o as f,e as r,f as n,C as y,g as w,K as q,L as G,D as R,h as H,Z}from"./index-Bl4hSf2D.js";import{S as J}from"./Store-DqdD8inb.js";const Q={class:"audio-upload"},W={class:"audio-player"},X={class:"audio-upload"},Y={class:"size"},x=["onClick"],ee=["onClick"],ne={__name:"Test3",setup(ae){const i=u([]),b=u(!1),m=u(null),h=u([]),U=u(),L=u(),S=async()=>{U.value=new Date;try{const a=await navigator.mediaDevices.getUserMedia({audio:!0});m.value=new MediaRecorder(a),h.value=[],m.value.ondataavailable=e=>{e.data.size>0&&h.value.push(e.data)},m.value.start(),b.value=!0,m.value.onstop=()=>{const e=new Blob(h.value,{type:"audio/mp3"});e.value=e,b.value=!1,a.getTracks().forEach(o=>o.stop()),E(e)}}catch(a){console.error("获取音频流失败：",a)}};function $(a,e){const o=new Date(a),t=new Date(e),s=Math.abs(t.getTime()-o.getTime());return Math.floor(s/1e3)}const E=async a=>{L.value=new Date;const e={name:`record-${i.value.length+1}.mp3`,url:URL.createObjectURL(a),blob:a,duration:`${$(U.value,L.value)}s`,size:D(a.size),file:new File([a],`record-${i.value.length+1}.mp3`,{type:"audio/mp3"})};i.value.unshift(e)},F=()=>{m.value&&(m.value.stop(),b.value=!1)},D=a=>`${(a/1024).toFixed(2)} KB`,T=a=>isNaN(a)||a===1/0?"未知":`${Math.floor(a)}s`,j=async a=>{const e=URL.createObjectURL(a),o=new Audio(URL.createObjectURL(a));return await new Promise(t=>{o.addEventListener("loadedmetadata",()=>{const s=o.duration,p=T(s),d={name:a.name,size:D(a.size),duration:p,isPlaying:!1,url:e,file:a,actualDuration:s};i.value.push(d),t()})}),!1},l=K({}),P=a=>{const e=i.value[a];l[a]||(l[a]=new Audio(e.url));const o=l[a];e.isPlaying?o.pause():(Object.entries(l).forEach(([t,s])=>{t!=a&&!s.paused&&(s.pause(),i.value[t].isPlaying=!1)}),o.play()),e.isPlaying=!e.isPlaying,o.addEventListener("ended",()=>{e.isPlaying=!1})},I=a=>{l[a]&&(l[a].pause(),l[a].src="",delete l[a]),i.value.splice(a,1)},z=u("second"),k=u(!1),O=u(null),M=async()=>{const a=i.value.map(t=>t.blob),e=new Blob(a,{type:"audio/wav"}),o=URL.createObjectURL(e);await N(o),URL.revokeObjectURL(o),Object.keys(l).forEach(t=>{l[t].pause(),l[t].src="",delete l[t]})},N=async a=>{const e=new FormData;e.append("text","在信息,爆炸的时代，我们每天被海量的数据包围，而阅读，这一古老的行为，却依旧散发着独特且强大的魅力，拥有着不可估量的力量。​阅读是一座取之不尽的知识宝库。通过书籍，我们能穿越时空，与古圣先贤对话。翻开《论语》，便能聆听孔子及其弟子的智慧言论，体悟为人处世的准则与道德修养的真谛；研读《物种起源》，跟随达尔文的脚步，探索生命演化的奥秘，了解物种如何在漫长岁月中适应环境、不断进化。无论是历史、科学、文学还是艺术，每一本书都是作者知识与经验的结晶，阅读使我们能在有限的生命里，汲取无限的知识养分，拓宽认知边界，丰富精神世界。​阅读能够深度拓展我们的思维。当沉浸在一本推理小说中，如阿加莎・克里斯蒂的作品，我们会跟随主角的视角，抽丝剥茧地分析线索，从错综复杂的情节中推断出真相，这一过程极大地锻炼了逻辑思维能力。而阅读哲学书籍，像尼采的《查拉图斯特拉如是说》，那些深邃的思想和独特的观点，会促使我们突破常规思维的局限，以全新视角审视世界、思考人生意义，培养批判性思维与创新思维，让我们在面对生活中的问题时，能从更多维度去分析和解决。​阅读更是心灵的滋养剂。在疲惫的生活中，一本温暖的治愈系书籍能成为心灵的避风港。当我们翻开《小王子》，被那纯真的故事和深刻的哲理触动，小王子与狐狸之间真挚的情感，让我们重新审视人与人之间的关系，唤起内心深处那份被遗忘的童真与善良，抚平生活带来的焦虑与创伤。文学作品中的优美语句，如潺潺溪流，润泽我们的心田，让我们在喧嚣尘世中寻得片刻宁静，感受到人性的美好与生命的价值。​阅读的力量，还在于它能引发共鸣，连接不同的灵魂。当我们读到与自己经历相似、情感契合的文字时，那种心有灵犀的感觉，仿佛在茫茫人海中找到了知音。这种共鸣跨越了年龄、性别、地域的界限，让全球的读者因共同喜爱的书籍相聚在一起，分享感悟，交流思想，形成一个庞大而温暖的精神共同体。​阅读，以无声的力量塑造着我们的知识体系、思维模式和心灵世界，如同点点繁星，照亮我们前行的道路，引领我们在人生旅途中不断探索、成长，领略世间无尽的美好。​不知你对这篇关于阅读力量的文章是否满意？要是你希望更换主题，或是在风格、内容侧重点上有其他想法，都能跟我讲，我会据此修改。"),e.append("text_lang","zh"),e.append("prompt_lang","zh"),e.append("streaming_mode","true"),e.append("ref_audio_path",a),console.log("最终 FormData 内容:",Array.from(e.entries()));const o=new URLSearchParams;for(const[p,d]of e.entries())o.append(p,d);const t=`/api2/tts?${o.toString()}`;new A.Howl({src:[t],xhr:{method:"GET"},html5:!0,format:["wav"],onplay:()=>{k.value=!0},onend:()=>{k.value=!1},onloaderror:(p,d)=>{console.error("音频加载失败",d),k.value=!1}}).play()};return(a,e)=>{const o=_("el-upload"),t=_("el-tab-pane"),s=_("el-col"),p=_("el-icon"),d=_("el-row"),V=_("el-tabs");return f(),B(d,null,{default:c(()=>[r(s,{span:12},{default:c(()=>[n("div",null,[n("audio",{ref_key:"audioPlayer",ref:O,controls:""},null,512),e[5]||(e[5]=n("h3",null,"输入音频",-1)),r(V,{modelValue:z.value,"onUpdate:modelValue":e[0]||(e[0]=v=>z.value=v),class:"demo-tabs"},{default:c(()=>[r(t,{label:"上传音频",name:"second"},{default:c(()=>[n("div",Q,[r(o,{class:"upload-component",accept:"audio/*","before-upload":j,"show-file-list":!1,"file-list":i.value,"on-remove":a.handleRemove,limit:0},{default:c(()=>e[1]||(e[1]=[n("div",{class:"upload-button"},[n("div",{class:"insert"}),n("h5",null,"添加或删除您的音频文件")],-1)])),_:1},8,["file-list","on-remove"])])]),_:1}),r(t,{label:"录制音频",name:"first"},{default:c(()=>[n("div",W,[b.value?(f(),y("div",{key:1,onClick:F,class:"record"},e[3]||(e[3]=[n("div",{class:"noRecord"},null,-1),w(" 停止录制 ")]))):(f(),y("div",{key:0,onClick:S,class:"record"},e[2]||(e[2]=[n("div",{class:"inRecord"},null,-1),w(" 点击开始录制 ")]))),e[4]||(e[4]=n("div",{style:{"font-size":"small",color:"#6b7280","margin-left":"20px"}}," *您可以使用自己的文本或下面的建议文本录制您的声音。",-1)),r(J)])]),_:1}),n("div",X,[(f(!0),y(q,null,G(i.value,(v,g)=>(f(),B(d,{key:g,class:"files"},{default:c(()=>[r(s,{span:2,class:"logo"}),r(s,{span:13,class:"file"},{default:c(()=>[w(R(v.name)+" ",1),n("div",Y,R(v.size),1)]),_:2},1024),r(s,{span:4},{default:c(()=>[w(R(v.duration),1)]),_:2},1024),r(s,{span:4,class:"btns"},{default:c(()=>[v.isPlaying?(f(),y("div",{key:1,class:"on",onClick:C=>P(g)},null,8,ee)):(f(),y("div",{key:0,class:"close",onClick:C=>P(g)},null,8,x)),r(p,{onClick:C=>I(g),class:"delete-btn",size:"25"},{default:c(()=>[r(H(Z))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))])]),_:1},8,["modelValue"]),n("button",{class:"next-btn",onClick:M},"创建")])]),_:1})]),_:1})}}};export{ne as default};
