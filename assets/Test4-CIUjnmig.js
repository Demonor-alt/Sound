import{_ as D,r as s,C as c,f as m,e as x,T as h,D as k,b as I,U as P,E as w,V as T,W as b,o as p}from"./index-Bl4hSf2D.js";import{_ as $,a as U,b as E,c as B}from"./speaker-DeKGlsBD.js";import{h as L}from"./howler-YKEUKyjS.js";const M={class:"audio_right"},N={class:"gap"},F={class:"audio_time"},H={class:"volume"},R={class:"volume_progress"},q={__name:"Test4",props:{buttonSize:{type:String,default:"30"},sliderLength:{type:String,default:"420"}},setup(f){const t=s(!1),l=s(null),u=s(0),i=s(.9),r=s(0),v=s("--"),d=s(!1),S=s(300);function g(e){if(e==="--")return"--";const a=Math.floor(e/60),n=Math.floor(e%60);return`${a}:${n<10?"0":""}${n}`}function V(){l.value&&l.value.seek(u.value/100*v.value)}function z(){l.value&&l.value.volume(i.value)}async function y(){if(t.value){l.value.pause(),t.value=!1,r.value=0,u.value=0;return}else t.value=!0;const e=new FormData;e.append("text","在信息爆炸的时代，我们每天被海量的数据包围，而阅读，这一古老的行为..."),e.append("text_lang","zh"),e.append("prompt_lang","zh"),e.append("streaming_mode","true"),e.append("ref_audio_path","D://雷军.mp3"),console.log("最终 FormData 内容:",Array.from(e.entries()));const a=new URLSearchParams;for(const[o,_]of e.entries())a.append(o,_);const n=`/api2/tts?${a.toString()}`;l.value=new L.Howl({src:[n],xhr:{method:"GET"},html5:!0,volume:i.value,format:["wav"],onplay:()=>{C()},onload:()=>{l.value.duration()&&l.value.duration()!==1/0&&(v.value=l.value.duration())},onend:()=>{t.value=!1,r.value=0,u.value=0},onloaderror:(o,_)=>{console.error("音频加载失败",_),_.value="音频加载失败",t.value=!1}}),l.value.play()}function C(){const e=setInterval(()=>{l.value&&t.value?(r.value=l.value.seek(),v.value!=="--"&&(u.value=r.value/v.value*100)):clearInterval(e)},500)}return(e,a)=>{const n=I("el-slider");return p(),c("div",M,[m("div",N,[t.value===!1?(p(),c("img",{key:0,onClick:y,class:"audio_icon",style:h({width:f.buttonSize+"px",height:f.buttonSize+"px"}),src:$,alt:"播放"},null,4)):(p(),c("img",{key:1,onClick:y,class:"audio_icon",style:h({width:f.buttonSize+"px",height:f.buttonSize+"px"}),src:U,alt:"暂停"},null,4)),m("div",F,[m("span",null,k(g(r.value))+" / "+k(g(v.value)),1)]),x(n,{modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=o=>u.value=o),"show-tooltip":!1,max:100,onInput:V,disabled:!t.value,class:"slider_box",style:h({width:S.value+"px"})},null,8,["modelValue","disabled","style"]),m("div",H,[P(m("div",R,[x(n,{"show-tooltip":!1,vertical:"",height:"100px",class:"volume_bar",max:1,modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=o=>i.value=o),step:"0.01",onChange:z},null,8,["modelValue"])],512),[[T,d.value]]),i.value<=0?(p(),c("img",{key:0,class:"volume_icon",onClick:a[2]||(a[2]=b(o=>d.value=!d.value,["stop"])),src:E,alt:""})):w("",!0),i.value>0?(p(),c("img",{key:1,class:"volume_icon",onClick:a[3]||(a[3]=b(o=>d.value=!d.value,["stop"])),src:B,alt:""})):w("",!0)])])])}}},j=D(q,[["__scopeId","data-v-64771459"]]);export{j as default};
